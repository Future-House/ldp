<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>ldp.agent package &#8212; ldp  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ldp.alg package" href="ldp.alg.html" />
    <link rel="prev" title="ldp package" href="ldp.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ldp-agent-package">
<h1>ldp.agent package<a class="headerlink" href="#ldp-agent-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ldp.agent.agent">
<span id="ldp-agent-agent-module"></span><h2>ldp.agent.agent module<a class="headerlink" href="#module-ldp.agent.agent" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.Agent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TAgentState</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent.Agent.from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.Agent.from_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent.Agent.get_asv">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TAgentState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TAgentState</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.Agent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent.Agent.init_state">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TAgentState</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.Agent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent.Agent.named_ops">
<span class="sig-name descname"><span class="pre">named_ops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.named_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.Agent.named_ops" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.nn.Module.named_parameters().</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.agent.</span></span><span class="sig-name descname"><span class="pre">AgentConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JsonValue</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/agent.html#AgentConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.AgentConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Configuration for specifying the type of agent i.e. the subclass of Agent above.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.agent_kwargs">
<span class="sig-name descname"><span class="pre">agent_kwargs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JsonValue</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.agent.AgentConfig.agent_kwargs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.agent_type">
<span class="sig-name descname"><span class="pre">agent_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.agent.AgentConfig.agent_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.construct_agent">
<span class="sig-name descname"><span class="pre">construct_agent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#AgentConfig.construct_agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent.AgentConfig.construct_agent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.agent.AgentConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.agent.agent.AgentConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.agent.AgentConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'agent_kwargs':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">JsonValue],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict,</span> <span class="pre">description=&quot;Keyword</span> <span class="pre">arguments</span> <span class="pre">to</span> <span class="pre">pass</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">agent's</span> <span class="pre">constructor.&quot;),</span> <span class="pre">'agent_type':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='The</span> <span class="pre">type</span> <span class="pre">of</span> <span class="pre">agent</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used.</span> <span class="pre">This</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">subclass</span> <span class="pre">of</span> <span class="pre">Agent</span> <span class="pre">above.')}</span></em><a class="headerlink" href="#ldp.agent.agent.AgentConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent.agent_client">
<span id="ldp-agent-agent-client-module"></span><h2>ldp.agent.agent_client module<a class="headerlink" href="#module-ldp.agent.agent_client" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.agent_client.HTTPAgentClient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.agent_client.</span></span><span class="sig-name descname"><span class="pre">HTTPAgentClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent_client.HTTPAgentClient" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TSerializableAgentState</span></code>]</p>
<p>Interact with an Agent running in a server via POST requests.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent_client.HTTPAgentClient.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TSerializableAgentState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TSerializableAgentState</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent_client.HTTPAgentClient.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.agent_client.HTTPAgentClient.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TSerializableAgentState</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent_client.HTTPAgentClient.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.agent.agent_client.make_simple_agent_server">
<span class="sig-prename descclassname"><span class="pre">ldp.agent.agent_client.</span></span><span class="sig-name descname"><span class="pre">make_simple_agent_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">FastAPI</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#make_simple_agent_server"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.agent_client.make_simple_agent_server" title="Link to this definition">¶</a></dt>
<dd><p>Make a FastAPI app designed to work with the above HTTPAgentClient.</p>
<p>Here’s how this works:
1. There is an entity orchestrating an Agent’s interactions with an Environment.</p>
<blockquote>
<div><p>A simple example of this is an integration test that sequentially calls
Agent.get_asv and Environment.step.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>That entity is given the above HTTPAgentClient. Any Agent.init_state or
Agent.get_asv calls the orchestration entity makes are actually
POST requests under the hood. The agent’s “brains” aren’t local.</p></li>
<li><p>Remotely, this server code is running, and is where the actual Agent logic lives.
An example of this is a remote server containing GPU(s).</p></li>
</ol>
</dd></dl>

</section>
<section id="module-ldp.agent.interactive_agent">
<span id="ldp-agent-interactive-agent-module"></span><h2>ldp.agent.interactive_agent module<a class="headerlink" href="#module-ldp.agent.interactive_agent" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.interactive_agent.InteractiveAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.interactive_agent.</span></span><span class="sig-name descname"><span class="pre">InteractiveAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/interactive_agent.html#InteractiveAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.interactive_agent.InteractiveAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>An “agent” that provides an interface for human users to interact with environments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.interactive_agent.InteractiveAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/interactive_agent.html#InteractiveAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.interactive_agent.InteractiveAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.interactive_agent.InteractiveAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/interactive_agent.html#InteractiveAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.interactive_agent.InteractiveAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent.memory_agent">
<span id="ldp-agent-memory-agent-module"></span><h2>ldp.agent.memory_agent module<a class="headerlink" href="#module-ldp.agent.memory_agent" title="Link to this heading">¶</a></h2>
<p>This module defines the MemoryAgent class, which extends a base agent model with memory.</p>
<p>capabilities. The MemoryAgent can pick and invoke tools based on the stored and retrieved
memories, formatted using specified prompts. A memory is typically a set of previous trajectories</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.memory_agent.</span></span><span class="sig-name descname"><span class="pre">MemoryAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*args,</span> <span class="pre">llm_model:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">sys_prompt:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">prompt:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;episode-memories&gt;\n&lt;description&gt;\nThese</span> <span class="pre">are</span> <span class="pre">relevant</span> <span class="pre">memories</span> <span class="pre">from</span> <span class="pre">previous</span> <span class="pre">attempts</span> <span class="pre">at</span> <span class="pre">similar</span> <span class="pre">tasks,</span> <span class="pre">along</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">taken</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">discounted</span> <span class="pre">cumulative</span> <span class="pre">reward</span> <span class="pre">from</span> <span class="pre">that</span> <span class="pre">action.</span> <span class="pre">A</span> <span class="pre">negative</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">failure,</span> <span class="pre">a</span> <span class="pre">positive</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">success.\n&lt;/description&gt;{memories}&lt;/episode-memories&gt;\n\nConsidering</span> <span class="pre">the</span> <span class="pre">memories,</span> <span class="pre">choose</span> <span class="pre">the</span> <span class="pre">next</span> <span class="pre">action.',</span> <span class="pre">query_factory:</span> <span class="pre">~collections.abc.Callable[[~collections.abc.Iterable[~aviary.message.Message]],</span> <span class="pre">~collections.abc.Awaitable[str]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">_default_query_factory&gt;,</span> <span class="pre">memory_prompt:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;memory&gt;&lt;obs&gt;{input}&lt;/obs&gt;&lt;action&gt;{output}&lt;/action&gt;&lt;reward&gt;{value}&lt;/reward&gt;&lt;/memory&gt;',</span> <span class="pre">num_memories:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/memory_agent.html#MemoryAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgent" title="ldp.agent.simple_agent.SimpleAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgent</span></code></a></p>
<p>Simple agent that can pick and invoke tools with memory.</p>
<p>NOTE: the MemoryAgent does not maintain an explicit value estimate,
it simply supplies previous trajectories via the prompt.
As such, the value estimate vhat will always be zero.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.default_query_factory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_query_factory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.default_query_factory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/memory_agent.html#MemoryAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.memory_prompt">
<span class="sig-name descname"><span class="pre">memory_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.memory_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.</span> <span class="pre">Trainable.'),</span> <span class="pre">'memory_prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='&lt;memory&gt;&lt;obs&gt;{input}&lt;/obs&gt;&lt;action&gt;{output}&lt;/action&gt;&lt;reward&gt;{value}&lt;/reward&gt;&lt;/memory&gt;',</span> <span class="pre">description='Prompt</span> <span class="pre">for</span> <span class="pre">formatting</span> <span class="pre">an</span> <span class="pre">individual</span> <span class="pre">memory.</span> <span class="pre">Use</span> <span class="pre">XML</span> <span class="pre">instead</span> <span class="pre">of</span> <span class="pre">JSON</span> <span class="pre">to</span> <span class="pre">avoid</span> <span class="pre">potential</span> <span class="pre">escaping</span> <span class="pre">issues.'),</span> <span class="pre">'num_memories':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=3,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">memories</span> <span class="pre">to</span> <span class="pre">retrieve</span> <span class="pre">from</span> <span class="pre">MemoryOp'),</span> <span class="pre">'prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='&lt;episode-memories&gt;\n&lt;description&gt;\nThese</span> <span class="pre">are</span> <span class="pre">relevant</span> <span class="pre">memories</span> <span class="pre">from</span> <span class="pre">previous</span> <span class="pre">attempts</span> <span class="pre">at</span> <span class="pre">similar</span> <span class="pre">tasks,</span> <span class="pre">along</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">taken</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">discounted</span> <span class="pre">cumulative</span> <span class="pre">reward</span> <span class="pre">from</span> <span class="pre">that</span> <span class="pre">action.</span> <span class="pre">A</span> <span class="pre">negative</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">failure,</span> <span class="pre">a</span> <span class="pre">positive</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">success.\n&lt;/description&gt;{memories}&lt;/episode-memories&gt;\n\nConsidering</span> <span class="pre">the</span> <span class="pre">memories,</span> <span class="pre">choose</span> <span class="pre">the</span> <span class="pre">next</span> <span class="pre">action.',</span> <span class="pre">description='Prompt</span> <span class="pre">that</span> <span class="pre">includes</span> <span class="pre">the</span> <span class="pre">memories.'),</span> <span class="pre">'query_factory':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">Awaitable[str]],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">_default_query_factory&gt;,</span> <span class="pre">description=&quot;Async</span> <span class="pre">function</span> <span class="pre">to</span> <span class="pre">generate</span> <span class="pre">a</span> <span class="pre">Memory</span> <span class="pre">query</span> <span class="pre">string</span> <span class="pre">from</span> <span class="pre">messages.</span> <span class="pre">It's</span> <span class="pre">async</span> <span class="pre">so</span> <span class="pre">this</span> <span class="pre">can</span> <span class="pre">involve</span> <span class="pre">an</span> <span class="pre">LLM</span> <span class="pre">completion</span> <span class="pre">if</span> <span class="pre">desired.&quot;,</span> <span class="pre">exclude=True),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Opt-in</span> <span class="pre">system</span> <span class="pre">prompt.</span> <span class="pre">If</span> <span class="pre">one</span> <span class="pre">is</span> <span class="pre">passed,</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">trainable,</span> <span class="pre">because</span> <span class="pre">this</span> <span class="pre">class</span> <span class="pre">is</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">quite</span> <span class="pre">simple</span> <span class="pre">as</span> <span class="pre">far</span> <span class="pre">as</span> <span class="pre">possible</span> <span class="pre">hyperparameters.')}</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.num_memories">
<span class="sig-name descname"><span class="pre">num_memories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.num_memories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.prompt">
<span class="sig-name descname"><span class="pre">prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.memory_agent.MemoryAgent.query_factory">
<span class="sig-name descname"><span class="pre">query_factory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.memory_agent.MemoryAgent.query_factory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent.react_agent">
<span id="ldp-agent-react-agent-module"></span><h2>ldp.agent.react_agent module<a class="headerlink" href="#module-ldp.agent.react_agent" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.react_agent.</span></span><span class="sig-name descname"><span class="pre">ReActAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'logprobs':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1,</span> <span class="pre">'top_logprobs':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Answer</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">questions</span> <span class="pre">as</span> <span class="pre">best</span> <span class="pre">you</span> <span class="pre">can.</span> <span class="pre">You</span> <span class="pre">have</span> <span class="pre">access</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">tools:\n\n{tools}\n\nUse</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">format:\n\nThought:</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">always</span> <span class="pre">think</span> <span class="pre">about</span> <span class="pre">what</span> <span class="pre">to</span> <span class="pre">do\nAction:</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">to</span> <span class="pre">take,</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">[{tool_names}]\nAction</span> <span class="pre">Input:</span> <span class="pre">comma</span> <span class="pre">separated</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">inputs</span> <span class="pre">to</span> <span class="pre">action</span> <span class="pre">as</span> <span class="pre">python</span> <span class="pre">tuple\nObservation:</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">action\n...</span> <span class="pre">(this</span> <span class="pre">Thought/Action/Action</span> <span class="pre">Input/Observation</span> <span class="pre">can</span> <span class="pre">repeat</span> <span class="pre">N</span> <span class="pre">times)\n\nExample:\n\nThought:</span> <span class="pre">I</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">get_weather</span> <span class="pre">tool\nAction:</span> <span class="pre">get_weather\nAction</span> <span class="pre">Input:</span> <span class="pre">&quot;New</span> <span class="pre">York&quot;,</span> <span class="pre">7\nObservation:</span> <span class="pre">The</span> <span class="pre">7</span> <span class="pre">day</span> <span class="pre">forecast</span> <span class="pre">for</span> <span class="pre">New</span> <span class="pre">York</span> <span class="pre">is</span> <span class="pre">[...]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_description_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods" title="ldp.graph.modules.react.ToolDescriptionMethods"><span class="pre">ToolDescriptionMethods</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ToolDescriptionMethods.STR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>An Act or ReAct Agent built to work with chat models.</p>
<p>Paper: <a class="reference external" href="https://arxiv.org/abs/2210.03629">https://arxiv.org/abs/2210.03629</a></p>
<p>The ReAct style is like so, and note Act style has no ‘Thought: ‘ entries:
System:</p>
<blockquote>
<div><p>Answer the following questions as best you can. You have access to the following tools:</p>
<blockquote>
<div><p>{tools}</p>
<p>Use the following format:</p>
<p>Thought: you should always think about what to do
Action: the action to take, should be one of [{tool_names}]
Action Input: the input to the action
Observation: the result of the action
… (this Thought/Action/Action Input/Observation can repeat N times)</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>User:</dt><dd><p>{questions}</p>
</dd>
<dt>Assistant:</dt><dd><p>Thought:
Action:
Action Input:</p>
</dd>
<dt>User:</dt><dd><p>Observation:</p>
</dd>
<dt>Assistant:</dt><dd><p>Thought:
Action:
Action Input:</p>
</dd>
</dl>
<p>…</p>
<p>One notable design decision is that ReAct’s state does not necessarily
track ToolRequestMessage. Recall that aviary is in a partially observable
domain, meaning we don’t need to have perfect symmetry with Environments.
Instead, ReActAgent’s state stores a ReAct-style message history, where the
messages are plain Message (and not a ToolRequestMessage).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.after_retry_failure_log">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_retry_failure_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">retry_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RetryCallState</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.after_retry_failure_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.after_retry_failure_log" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.make_act_agent">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_act_agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.make_act_agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.make_act_agent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1,</span> <span class="pre">'logprobs':</span> <span class="pre">True,</span> <span class="pre">'top_logprobs':</span> <span class="pre">1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.'),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='Answer</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">questions</span> <span class="pre">as</span> <span class="pre">best</span> <span class="pre">you</span> <span class="pre">can.</span> <span class="pre">You</span> <span class="pre">have</span> <span class="pre">access</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">tools:\n\n{tools}\n\nUse</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">format:\n\nThought:</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">always</span> <span class="pre">think</span> <span class="pre">about</span> <span class="pre">what</span> <span class="pre">to</span> <span class="pre">do\nAction:</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">to</span> <span class="pre">take,</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">[{tool_names}]\nAction</span> <span class="pre">Input:</span> <span class="pre">comma</span> <span class="pre">separated</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">inputs</span> <span class="pre">to</span> <span class="pre">action</span> <span class="pre">as</span> <span class="pre">python</span> <span class="pre">tuple\nObservation:</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">action\n...</span> <span class="pre">(this</span> <span class="pre">Thought/Action/Action</span> <span class="pre">Input/Observation</span> <span class="pre">can</span> <span class="pre">repeat</span> <span class="pre">N</span> <span class="pre">times)\n\nExample:\n\nThought:</span> <span class="pre">I</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">get_weather</span> <span class="pre">tool\nAction:</span> <span class="pre">get_weather\nAction</span> <span class="pre">Input:</span> <span class="pre">&quot;New</span> <span class="pre">York&quot;,</span> <span class="pre">7\nObservation:</span> <span class="pre">The</span> <span class="pre">7</span> <span class="pre">day</span> <span class="pre">forecast</span> <span class="pre">for</span> <span class="pre">New</span> <span class="pre">York</span> <span class="pre">is</span> <span class="pre">[...]',</span> <span class="pre">description='Learnable</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">template,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">ReAct.'),</span> <span class="pre">'tool_description_method':</span> <span class="pre">FieldInfo(annotation=ToolDescriptionMethods,</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;ToolDescriptionMethods.STR:</span> <span class="pre">'describe_str'&gt;,</span> <span class="pre">description=&quot;Method</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">describe</span> <span class="pre">the</span> <span class="pre">tools,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">'str'</span> <span class="pre">description.&quot;)}</span></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.sys_prompt">
<span class="sig-name descname"><span class="pre">sys_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.sys_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.react_agent.ReActAgent.tool_description_method">
<span class="sig-name descname"><span class="pre">tool_description_method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods" title="ldp.graph.modules.react.ToolDescriptionMethods"><span class="pre">ToolDescriptionMethods</span></a></em><a class="headerlink" href="#ldp.agent.react_agent.ReActAgent.tool_description_method" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent.simple_agent">
<span id="ldp-agent-simple-agent-module"></span><h2>ldp.agent.simple_agent module<a class="headerlink" href="#module-ldp.agent.simple_agent" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.simple_agent.</span></span><span class="sig-name descname"><span class="pre">SimpleAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>Simple agent that can pick and invoke tools with a language model.</p>
<p>It does not have a system prompt because it’s meant to be lightweight.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.</span> <span class="pre">Trainable.'),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Opt-in</span> <span class="pre">system</span> <span class="pre">prompt.</span> <span class="pre">If</span> <span class="pre">one</span> <span class="pre">is</span> <span class="pre">passed,</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">trainable,</span> <span class="pre">because</span> <span class="pre">this</span> <span class="pre">class</span> <span class="pre">is</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">quite</span> <span class="pre">simple</span> <span class="pre">as</span> <span class="pre">far</span> <span class="pre">as</span> <span class="pre">possible</span> <span class="pre">hyperparameters.')}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgent.sys_prompt">
<span class="sig-name descname"><span class="pre">sys_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgent.sys_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.simple_agent.</span></span><span class="sig-name descname"><span class="pre">SimpleAgentState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">messages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ToolResponseMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgentState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Simple bucket for an Agent to access tools and store messages.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.get_next_state">
<span class="sig-name descname"><span class="pre">get_next_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgentState.get_next_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.get_next_state" title="Link to this definition">¶</a></dt>
<dd><p>Get the next agent state without mutating the optional prior state.</p>
<p>Do not mutate self here, just read from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – Optional observation messages to use in creating the next state.</p></li>
<li><p><strong>tools</strong> – Optional list of tools available to the agent. If unspecified, these
should be pulled from the prior_state.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments to pass to this class’s constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The next agent state (which is not an in-place change to self).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.messages">
<span class="sig-name descname"><span class="pre">messages</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ToolResponseMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.messages" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'messages':</span> <span class="pre">FieldInfo(annotation=list[Union[ToolRequestMessage,</span> <span class="pre">ToolResponseMessage,</span> <span class="pre">Message]],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=list),</span> <span class="pre">'tools':</span> <span class="pre">FieldInfo(annotation=list[Tool],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=list)}</span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.simple_agent.SimpleAgentState.tools">
<span class="sig-name descname"><span class="pre">tools</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.simple_agent.SimpleAgentState.tools" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent.tree_of_thoughts_agent">
<span id="ldp-agent-tree-of-thoughts-agent-module"></span><h2>ldp.agent.tree_of_thoughts_agent module<a class="headerlink" href="#module-ldp.agent.tree_of_thoughts_agent" title="Link to this heading">¶</a></h2>
<p>Module for the Tree of Thoughts agent.</p>
<p>This module defines the Tree of Thoughts agent which uses a language model to generate and evaluate possible
steps in a puzzle or problem-solving environment. The agent employs a tree search mechanism to explore different
solutions and selects the most promising ones based on evaluations.</p>
<p>This module is based on the following paper: <a class="reference external" href="https://openreview.net/forum?id=5Xc1ecxO1h">https://openreview.net/forum?id=5Xc1ecxO1h</a></p>
<p>Note: TreeofThoughtsAgent is currently tested as a baseline agent for Game of 24. It does not yet support tool calls
that operate on the intermediate reasoning steps. This would probably entail a redefinition of the POMDP to
undertake intermediate reasoning steps as environment steps.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.tree_of_thoughts_agent.</span></span><span class="sig-name descname"><span class="pre">TreeofThoughtsAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*args,</span> <span class="pre">llm_model:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">value_prompt_func:</span> <span class="pre">~collections.abc.Callable[[str,</span> <span class="pre">str],</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">proposal_prompt_func:</span> <span class="pre">~collections.abc.Callable[[str,</span> <span class="pre">str],</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>Tree of Thoughts Agent.</p>
<p>This agent uses a tree search mechanism combined with an LLM to generate and evaluate
possible steps in a problem-solving environment. It is designed to explore different solutions
and select the most promising ones based on a heuristic evaluation function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_select_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Generate and evaluate possible steps in the problem-solving process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – The current state of the agent.</p></li>
<li><p><strong>obs</strong> – The observations provided to the agent.</p></li>
<li><p><strong>eval_function</strong> – Function to evaluate the generated paths in the tree.</p></li>
<li><p><strong>n_steps</strong> – Number of steps to generate. Defaults to 0. Dictated by the environment.</p></li>
<li><p><strong>n_select_samples</strong> – Number of tree nodes to select to explore in each step. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation, the new state of the agent, and the number representing the value (0).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.'),</span> <span class="pre">'proposal_prompt_func':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">str],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">description='Function</span> <span class="pre">to</span> <span class="pre">format</span> <span class="pre">proposal</span> <span class="pre">prompt</span> <span class="pre">template.'),</span> <span class="pre">'value_prompt_func':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">str],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">description='Function</span> <span class="pre">to</span> <span class="pre">format</span> <span class="pre">value</span> <span class="pre">prompt</span> <span class="pre">template.')}</span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.proposal_prompt_func">
<span class="sig-name descname"><span class="pre">proposal_prompt_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.proposal_prompt_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.value_prompt_func">
<span class="sig-name descname"><span class="pre">value_prompt_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.tree_of_thoughts_agent.TreeofThoughtsAgent.value_prompt_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.agent">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ldp.agent" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.Agent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TAgentState</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.Agent.from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.Agent.from_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.Agent.get_asv">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TAgentState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TAgentState</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.Agent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.Agent.init_state">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TAgentState</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.Agent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.Agent.named_ops">
<span class="sig-name descname"><span class="pre">named_ops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#Agent.named_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.Agent.named_ops" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.nn.Module.named_parameters().</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">AgentConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JsonValue</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/agent.html#AgentConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.AgentConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Configuration for specifying the type of agent i.e. the subclass of Agent above.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.agent_kwargs">
<span class="sig-name descname"><span class="pre">agent_kwargs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">JsonValue</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.AgentConfig.agent_kwargs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.agent_type">
<span class="sig-name descname"><span class="pre">agent_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.AgentConfig.agent_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.construct_agent">
<span class="sig-name descname"><span class="pre">construct_agent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/agent.html#AgentConfig.construct_agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.AgentConfig.construct_agent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.AgentConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.agent.AgentConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.AgentConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'agent_kwargs':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">JsonValue],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict,</span> <span class="pre">description=&quot;Keyword</span> <span class="pre">arguments</span> <span class="pre">to</span> <span class="pre">pass</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">agent's</span> <span class="pre">constructor.&quot;),</span> <span class="pre">'agent_type':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='The</span> <span class="pre">type</span> <span class="pre">of</span> <span class="pre">agent</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used.</span> <span class="pre">This</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">subclass</span> <span class="pre">of</span> <span class="pre">Agent</span> <span class="pre">above.')}</span></em><a class="headerlink" href="#ldp.agent.AgentConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.DefaultLLMModelNames">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">DefaultLLMModelNames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent.html#DefaultLLMModelNames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.DefaultLLMModelNames" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></p>
<p>Defaults for LLM models, pin exact versions for performance stability.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.DefaultLLMModelNames.OPENAI">
<span class="sig-name descname"><span class="pre">OPENAI</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gpt-4o-2024-08-06'</span></em><a class="headerlink" href="#ldp.agent.DefaultLLMModelNames.OPENAI" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.HTTPAgentClient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">HTTPAgentClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.HTTPAgentClient" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TSerializableAgentState</span></code>]</p>
<p>Interact with an Agent running in a server via POST requests.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.HTTPAgentClient.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TSerializableAgentState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TSerializableAgentState</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.HTTPAgentClient.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.HTTPAgentClient.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TSerializableAgentState</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#HTTPAgentClient.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.HTTPAgentClient.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">MemoryAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*args,</span> <span class="pre">llm_model:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">sys_prompt:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">prompt:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;episode-memories&gt;\n&lt;description&gt;\nThese</span> <span class="pre">are</span> <span class="pre">relevant</span> <span class="pre">memories</span> <span class="pre">from</span> <span class="pre">previous</span> <span class="pre">attempts</span> <span class="pre">at</span> <span class="pre">similar</span> <span class="pre">tasks,</span> <span class="pre">along</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">taken</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">discounted</span> <span class="pre">cumulative</span> <span class="pre">reward</span> <span class="pre">from</span> <span class="pre">that</span> <span class="pre">action.</span> <span class="pre">A</span> <span class="pre">negative</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">failure,</span> <span class="pre">a</span> <span class="pre">positive</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">success.\n&lt;/description&gt;{memories}&lt;/episode-memories&gt;\n\nConsidering</span> <span class="pre">the</span> <span class="pre">memories,</span> <span class="pre">choose</span> <span class="pre">the</span> <span class="pre">next</span> <span class="pre">action.',</span> <span class="pre">query_factory:</span> <span class="pre">~collections.abc.Callable[[~collections.abc.Iterable[~aviary.message.Message]],</span> <span class="pre">~collections.abc.Awaitable[str]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">_default_query_factory&gt;,</span> <span class="pre">memory_prompt:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;memory&gt;&lt;obs&gt;{input}&lt;/obs&gt;&lt;action&gt;{output}&lt;/action&gt;&lt;reward&gt;{value}&lt;/reward&gt;&lt;/memory&gt;',</span> <span class="pre">num_memories:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/memory_agent.html#MemoryAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.MemoryAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgent" title="ldp.agent.simple_agent.SimpleAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgent</span></code></a></p>
<p>Simple agent that can pick and invoke tools with memory.</p>
<p>NOTE: the MemoryAgent does not maintain an explicit value estimate,
it simply supplies previous trajectories via the prompt.
As such, the value estimate vhat will always be zero.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.default_query_factory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_query_factory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#ldp.agent.MemoryAgent.default_query_factory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/memory_agent.html#MemoryAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.MemoryAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.memory_prompt">
<span class="sig-name descname"><span class="pre">memory_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.memory_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.</span> <span class="pre">Trainable.'),</span> <span class="pre">'memory_prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='&lt;memory&gt;&lt;obs&gt;{input}&lt;/obs&gt;&lt;action&gt;{output}&lt;/action&gt;&lt;reward&gt;{value}&lt;/reward&gt;&lt;/memory&gt;',</span> <span class="pre">description='Prompt</span> <span class="pre">for</span> <span class="pre">formatting</span> <span class="pre">an</span> <span class="pre">individual</span> <span class="pre">memory.</span> <span class="pre">Use</span> <span class="pre">XML</span> <span class="pre">instead</span> <span class="pre">of</span> <span class="pre">JSON</span> <span class="pre">to</span> <span class="pre">avoid</span> <span class="pre">potential</span> <span class="pre">escaping</span> <span class="pre">issues.'),</span> <span class="pre">'num_memories':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=3,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">memories</span> <span class="pre">to</span> <span class="pre">retrieve</span> <span class="pre">from</span> <span class="pre">MemoryOp'),</span> <span class="pre">'prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='&lt;episode-memories&gt;\n&lt;description&gt;\nThese</span> <span class="pre">are</span> <span class="pre">relevant</span> <span class="pre">memories</span> <span class="pre">from</span> <span class="pre">previous</span> <span class="pre">attempts</span> <span class="pre">at</span> <span class="pre">similar</span> <span class="pre">tasks,</span> <span class="pre">along</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">taken</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">discounted</span> <span class="pre">cumulative</span> <span class="pre">reward</span> <span class="pre">from</span> <span class="pre">that</span> <span class="pre">action.</span> <span class="pre">A</span> <span class="pre">negative</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">failure,</span> <span class="pre">a</span> <span class="pre">positive</span> <span class="pre">reward</span> <span class="pre">is</span> <span class="pre">success.\n&lt;/description&gt;{memories}&lt;/episode-memories&gt;\n\nConsidering</span> <span class="pre">the</span> <span class="pre">memories,</span> <span class="pre">choose</span> <span class="pre">the</span> <span class="pre">next</span> <span class="pre">action.',</span> <span class="pre">description='Prompt</span> <span class="pre">that</span> <span class="pre">includes</span> <span class="pre">the</span> <span class="pre">memories.'),</span> <span class="pre">'query_factory':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">Awaitable[str]],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">_default_query_factory&gt;,</span> <span class="pre">description=&quot;Async</span> <span class="pre">function</span> <span class="pre">to</span> <span class="pre">generate</span> <span class="pre">a</span> <span class="pre">Memory</span> <span class="pre">query</span> <span class="pre">string</span> <span class="pre">from</span> <span class="pre">messages.</span> <span class="pre">It's</span> <span class="pre">async</span> <span class="pre">so</span> <span class="pre">this</span> <span class="pre">can</span> <span class="pre">involve</span> <span class="pre">an</span> <span class="pre">LLM</span> <span class="pre">completion</span> <span class="pre">if</span> <span class="pre">desired.&quot;,</span> <span class="pre">exclude=True),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Opt-in</span> <span class="pre">system</span> <span class="pre">prompt.</span> <span class="pre">If</span> <span class="pre">one</span> <span class="pre">is</span> <span class="pre">passed,</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">trainable,</span> <span class="pre">because</span> <span class="pre">this</span> <span class="pre">class</span> <span class="pre">is</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">quite</span> <span class="pre">simple</span> <span class="pre">as</span> <span class="pre">far</span> <span class="pre">as</span> <span class="pre">possible</span> <span class="pre">hyperparameters.')}</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.num_memories">
<span class="sig-name descname"><span class="pre">num_memories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.num_memories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.prompt">
<span class="sig-name descname"><span class="pre">prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.query_factory">
<span class="sig-name descname"><span class="pre">query_factory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.query_factory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.MemoryAgent.sys_prompt">
<span class="sig-name descname"><span class="pre">sys_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.agent.MemoryAgent.sys_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">ReActAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'logprobs':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1,</span> <span class="pre">'top_logprobs':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Answer</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">questions</span> <span class="pre">as</span> <span class="pre">best</span> <span class="pre">you</span> <span class="pre">can.</span> <span class="pre">You</span> <span class="pre">have</span> <span class="pre">access</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">tools:\n\n{tools}\n\nUse</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">format:\n\nThought:</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">always</span> <span class="pre">think</span> <span class="pre">about</span> <span class="pre">what</span> <span class="pre">to</span> <span class="pre">do\nAction:</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">to</span> <span class="pre">take,</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">[{tool_names}]\nAction</span> <span class="pre">Input:</span> <span class="pre">comma</span> <span class="pre">separated</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">inputs</span> <span class="pre">to</span> <span class="pre">action</span> <span class="pre">as</span> <span class="pre">python</span> <span class="pre">tuple\nObservation:</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">action\n...</span> <span class="pre">(this</span> <span class="pre">Thought/Action/Action</span> <span class="pre">Input/Observation</span> <span class="pre">can</span> <span class="pre">repeat</span> <span class="pre">N</span> <span class="pre">times)\n\nExample:\n\nThought:</span> <span class="pre">I</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">get_weather</span> <span class="pre">tool\nAction:</span> <span class="pre">get_weather\nAction</span> <span class="pre">Input:</span> <span class="pre">&quot;New</span> <span class="pre">York&quot;,</span> <span class="pre">7\nObservation:</span> <span class="pre">The</span> <span class="pre">7</span> <span class="pre">day</span> <span class="pre">forecast</span> <span class="pre">for</span> <span class="pre">New</span> <span class="pre">York</span> <span class="pre">is</span> <span class="pre">[...]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_description_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods" title="ldp.graph.modules.react.ToolDescriptionMethods"><span class="pre">ToolDescriptionMethods</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ToolDescriptionMethods.STR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.ReActAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>An Act or ReAct Agent built to work with chat models.</p>
<p>Paper: <a class="reference external" href="https://arxiv.org/abs/2210.03629">https://arxiv.org/abs/2210.03629</a></p>
<p>The ReAct style is like so, and note Act style has no ‘Thought: ‘ entries:
System:</p>
<blockquote>
<div><p>Answer the following questions as best you can. You have access to the following tools:</p>
<blockquote>
<div><p>{tools}</p>
<p>Use the following format:</p>
<p>Thought: you should always think about what to do
Action: the action to take, should be one of [{tool_names}]
Action Input: the input to the action
Observation: the result of the action
… (this Thought/Action/Action Input/Observation can repeat N times)</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>User:</dt><dd><p>{questions}</p>
</dd>
<dt>Assistant:</dt><dd><p>Thought:
Action:
Action Input:</p>
</dd>
<dt>User:</dt><dd><p>Observation:</p>
</dd>
<dt>Assistant:</dt><dd><p>Thought:
Action:
Action Input:</p>
</dd>
</dl>
<p>…</p>
<p>One notable design decision is that ReAct’s state does not necessarily
track ToolRequestMessage. Recall that aviary is in a partially observable
domain, meaning we don’t need to have perfect symmetry with Environments.
Instead, ReActAgent’s state stores a ReAct-style message history, where the
messages are plain Message (and not a ToolRequestMessage).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.after_retry_failure_log">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_retry_failure_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">retry_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RetryCallState</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.after_retry_failure_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.ReActAgent.after_retry_failure_log" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.ReActAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.ReActAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.ReActAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.make_act_agent">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_act_agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/agent/react_agent.html#ReActAgent.make_act_agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.ReActAgent.make_act_agent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.ReActAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.ReActAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1,</span> <span class="pre">'logprobs':</span> <span class="pre">True,</span> <span class="pre">'top_logprobs':</span> <span class="pre">1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.'),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='Answer</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">questions</span> <span class="pre">as</span> <span class="pre">best</span> <span class="pre">you</span> <span class="pre">can.</span> <span class="pre">You</span> <span class="pre">have</span> <span class="pre">access</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">tools:\n\n{tools}\n\nUse</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">format:\n\nThought:</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">always</span> <span class="pre">think</span> <span class="pre">about</span> <span class="pre">what</span> <span class="pre">to</span> <span class="pre">do\nAction:</span> <span class="pre">the</span> <span class="pre">action</span> <span class="pre">to</span> <span class="pre">take,</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">[{tool_names}]\nAction</span> <span class="pre">Input:</span> <span class="pre">comma</span> <span class="pre">separated</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">inputs</span> <span class="pre">to</span> <span class="pre">action</span> <span class="pre">as</span> <span class="pre">python</span> <span class="pre">tuple\nObservation:</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">action\n...</span> <span class="pre">(this</span> <span class="pre">Thought/Action/Action</span> <span class="pre">Input/Observation</span> <span class="pre">can</span> <span class="pre">repeat</span> <span class="pre">N</span> <span class="pre">times)\n\nExample:\n\nThought:</span> <span class="pre">I</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">get_weather</span> <span class="pre">tool\nAction:</span> <span class="pre">get_weather\nAction</span> <span class="pre">Input:</span> <span class="pre">&quot;New</span> <span class="pre">York&quot;,</span> <span class="pre">7\nObservation:</span> <span class="pre">The</span> <span class="pre">7</span> <span class="pre">day</span> <span class="pre">forecast</span> <span class="pre">for</span> <span class="pre">New</span> <span class="pre">York</span> <span class="pre">is</span> <span class="pre">[...]',</span> <span class="pre">description='Learnable</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">template,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">ReAct.'),</span> <span class="pre">'tool_description_method':</span> <span class="pre">FieldInfo(annotation=ToolDescriptionMethods,</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;ToolDescriptionMethods.STR:</span> <span class="pre">'describe_str'&gt;,</span> <span class="pre">description=&quot;Method</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">describe</span> <span class="pre">the</span> <span class="pre">tools,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">'str'</span> <span class="pre">description.&quot;)}</span></em><a class="headerlink" href="#ldp.agent.ReActAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.sys_prompt">
<span class="sig-name descname"><span class="pre">sys_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.agent.ReActAgent.sys_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.ReActAgent.tool_description_method">
<span class="sig-name descname"><span class="pre">tool_description_method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods" title="ldp.graph.modules.react.ToolDescriptionMethods"><span class="pre">ToolDescriptionMethods</span></a></em><a class="headerlink" href="#ldp.agent.ReActAgent.tool_description_method" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">SimpleAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.SimpleAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>Simple agent that can pick and invoke tools with a language model.</p>
<p>It does not have a system prompt because it’s meant to be lightweight.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.SimpleAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Get new action, state, and value given state and observation messages.</p>
<p>NOTE: the method’s name has action listed before state to help you realize it’s
a new state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – Optional current agent state, pass None if irrelevant.
This can be something like agent memory.</p></li>
<li><p><strong>obs</strong> – Most recent list of observation messages from the environment’s steps.
If more observations than the most recent list are necessary, track them
in the agent state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Three-tuple of new action, new agent state, and estimated value. The</dt><dd><p>agent_state is returned as a copy so that you can safely mutate it
without affecting the original. The estimated value is the agent’s
estimate of the future rewards given the input state and observations,
and is used for RL training.  If estimated value doesn’t matter, just
return 0. The value could also come from a Q-value evaluated at the
action chosen by the agent.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.SimpleAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.SimpleAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.</span> <span class="pre">Trainable.'),</span> <span class="pre">'sys_prompt':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Opt-in</span> <span class="pre">system</span> <span class="pre">prompt.</span> <span class="pre">If</span> <span class="pre">one</span> <span class="pre">is</span> <span class="pre">passed,</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">prompt</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">trainable,</span> <span class="pre">because</span> <span class="pre">this</span> <span class="pre">class</span> <span class="pre">is</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">quite</span> <span class="pre">simple</span> <span class="pre">as</span> <span class="pre">far</span> <span class="pre">as</span> <span class="pre">possible</span> <span class="pre">hyperparameters.')}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgent.sys_prompt">
<span class="sig-name descname"><span class="pre">sys_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.agent.SimpleAgent.sys_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">SimpleAgentState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">messages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ToolResponseMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgentState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.SimpleAgentState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Simple bucket for an Agent to access tools and store messages.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.get_next_state">
<span class="sig-name descname"><span class="pre">get_next_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/agent/simple_agent.html#SimpleAgentState.get_next_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.SimpleAgentState.get_next_state" title="Link to this definition">¶</a></dt>
<dd><p>Get the next agent state without mutating the optional prior state.</p>
<p>Do not mutate self here, just read from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – Optional observation messages to use in creating the next state.</p></li>
<li><p><strong>tools</strong> – Optional list of tools available to the agent. If unspecified, these
should be pulled from the prior_state.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments to pass to this class’s constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The next agent state (which is not an in-place change to self).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.messages">
<span class="sig-name descname"><span class="pre">messages</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ToolResponseMessage</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.SimpleAgentState.messages" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgentState.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgentState.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'messages':</span> <span class="pre">FieldInfo(annotation=list[Union[ToolRequestMessage,</span> <span class="pre">ToolResponseMessage,</span> <span class="pre">Message]],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=list),</span> <span class="pre">'tools':</span> <span class="pre">FieldInfo(annotation=list[Tool],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=list)}</span></em><a class="headerlink" href="#ldp.agent.SimpleAgentState.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.SimpleAgentState.tools">
<span class="sig-name descname"><span class="pre">tools</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.SimpleAgentState.tools" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">TreeofThoughtsAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*args,</span> <span class="pre">llm_model:</span> <span class="pre">dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">value_prompt_func:</span> <span class="pre">~collections.abc.Callable[[str,</span> <span class="pre">str],</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">proposal_prompt_func:</span> <span class="pre">~collections.abc.Callable[[str,</span> <span class="pre">str],</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a>[<a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleAgentState</span></code></a>]</p>
<p>Tree of Thoughts Agent.</p>
<p>This agent uses a tree search mechanism combined with an LLM to generate and evaluate
possible steps in a problem-solving environment. It is designed to explore different solutions
and select the most promising ones based on a heuristic evaluation function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_select_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent.get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Generate and evaluate possible steps in the problem-solving process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – The current state of the agent.</p></li>
<li><p><strong>obs</strong> – The observations provided to the agent.</p></li>
<li><p><strong>eval_function</strong> – Function to evaluate the generated paths in the tree.</p></li>
<li><p><strong>n_steps</strong> – Number of steps to generate. Defaults to 0. Dictated by the environment.</p></li>
<li><p><strong>n_select_samples</strong> – Number of tree nodes to select to explore in each step. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation, the new state of the agent, and the number representing the value (0).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a></span></span><a class="reference internal" href="_modules/ldp/agent/tree_of_thoughts_agent.html#TreeofThoughtsAgent.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.init_state" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the first agent state with the provided tools.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.llm_model">
<span class="sig-name descname"><span class="pre">llm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.llm_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'frozen':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'llm_model':</span> <span class="pre">FieldInfo(annotation=dict[str,</span> <span class="pre">Any],</span> <span class="pre">required=False,</span> <span class="pre">default={'model':</span> <span class="pre">'gpt-4o-2024-08-06',</span> <span class="pre">'temperature':</span> <span class="pre">0.1},</span> <span class="pre">description='Starting</span> <span class="pre">configuration</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">LLM</span> <span class="pre">model.'),</span> <span class="pre">'proposal_prompt_func':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">str],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">description='Function</span> <span class="pre">to</span> <span class="pre">format</span> <span class="pre">proposal</span> <span class="pre">prompt</span> <span class="pre">template.'),</span> <span class="pre">'value_prompt_func':</span> <span class="pre">FieldInfo(annotation=Callable[list,</span> <span class="pre">str],</span> <span class="pre">required=False,</span> <span class="pre">default=&lt;function</span> <span class="pre">TreeofThoughtsAgent.&lt;lambda&gt;&gt;,</span> <span class="pre">description='Function</span> <span class="pre">to</span> <span class="pre">format</span> <span class="pre">value</span> <span class="pre">prompt</span> <span class="pre">template.')}</span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.proposal_prompt_func">
<span class="sig-name descname"><span class="pre">proposal_prompt_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.proposal_prompt_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.agent.TreeofThoughtsAgent.value_prompt_func">
<span class="sig-name descname"><span class="pre">value_prompt_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.agent.TreeofThoughtsAgent.value_prompt_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.agent.make_simple_agent_server">
<span class="sig-prename descclassname"><span class="pre">ldp.agent.</span></span><span class="sig-name descname"><span class="pre">make_simple_agent_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.agent.simple_agent.SimpleAgentState" title="ldp.agent.simple_agent.SimpleAgentState"><span class="pre">SimpleAgentState</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">FastAPI</span></span></span><a class="reference internal" href="_modules/ldp/agent/agent_client.html#make_simple_agent_server"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.agent.make_simple_agent_server" title="Link to this definition">¶</a></dt>
<dd><p>Make a FastAPI app designed to work with the above HTTPAgentClient.</p>
<p>Here’s how this works:
1. There is an entity orchestrating an Agent’s interactions with an Environment.</p>
<blockquote>
<div><p>A simple example of this is an integration test that sequentially calls
Agent.get_asv and Environment.step.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>That entity is given the above HTTPAgentClient. Any Agent.init_state or
Agent.get_asv calls the orchestration entity makes are actually
POST requests under the hood. The agent’s “brains” aren’t local.</p></li>
<li><p>Remotely, this server code is running, and is where the actual Agent logic lives.
An example of this is a remote server containing GPU(s).</p></li>
</ol>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ldp</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ldp</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ldp.html">ldp package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ldp.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">ldp.agent package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.html">ldp.alg package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.html">ldp.graph package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.llms.html">ldp.llms package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.data_structures">ldp.data_structures module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.main">ldp.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.shims">ldp.shims module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.utils">ldp.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ldp</a><ul>
  <li><a href="ldp.html">ldp package</a><ul>
      <li>Previous: <a href="ldp.html" title="previous chapter">ldp package</a></li>
      <li>Next: <a href="ldp.alg.html" title="next chapter">ldp.alg package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/ldp.agent.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>