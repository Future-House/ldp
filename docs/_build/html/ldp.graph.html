<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>ldp.graph package &#8212; ldp  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ldp.graph.modules package" href="ldp.graph.modules.html" />
    <link rel="prev" title="ldp.alg.optimizer package" href="ldp.alg.optimizer.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ldp-graph-package">
<h1>ldp.graph package<a class="headerlink" href="#ldp-graph-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ldp.graph.modules.html">ldp.graph.modules package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#module-ldp.graph.modules.llm_call">ldp.graph.modules.llm_call module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.llm_call.ParsedLLMCallModule"><code class="docutils literal notranslate"><span class="pre">ParsedLLMCallModule</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#module-ldp.graph.modules.react">ldp.graph.modules.react module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ReActModule"><code class="docutils literal notranslate"><span class="pre">ReActModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ReActModule.parse_message"><code class="docutils literal notranslate"><span class="pre">ReActModule.parse_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods.JSON"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.JSON</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods.STR"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.STR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods.XML"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.XML</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.ToolDescriptionMethods.get_prompt_prefix"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.get_prompt_prefix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.react.parse_message"><code class="docutils literal notranslate"><span class="pre">parse_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#module-ldp.graph.modules.reflect">ldp.graph.modules.reflect module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModule"><code class="docutils literal notranslate"><span class="pre">ReflectModule</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModuleConfig"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModuleConfig.llm_model"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.llm_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModuleConfig.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModuleConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.reflect.ReflectModuleConfig.model_fields"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_fields</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#module-ldp.graph.modules.thought">ldp.graph.modules.thought module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.thought.ThoughtModule"><code class="docutils literal notranslate"><span class="pre">ThoughtModule</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.graph.modules.html#module-ldp.graph.modules">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ParsedLLMCallModule"><code class="docutils literal notranslate"><span class="pre">ParsedLLMCallModule</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReActModule"><code class="docutils literal notranslate"><span class="pre">ReActModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReActModule.parse_message"><code class="docutils literal notranslate"><span class="pre">ReActModule.parse_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModule"><code class="docutils literal notranslate"><span class="pre">ReflectModule</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModuleConfig"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModuleConfig.llm_model"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.llm_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModuleConfig.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModuleConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ReflectModuleConfig.model_fields"><code class="docutils literal notranslate"><span class="pre">ReflectModuleConfig.model_fields</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ThoughtModule"><code class="docutils literal notranslate"><span class="pre">ThoughtModule</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ToolDescriptionMethods"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ToolDescriptionMethods.JSON"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.JSON</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ToolDescriptionMethods.STR"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.STR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ToolDescriptionMethods.XML"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.XML</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.ToolDescriptionMethods.get_prompt_prefix"><code class="docutils literal notranslate"><span class="pre">ToolDescriptionMethods.get_prompt_prefix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.graph.modules.html#ldp.graph.modules.parse_message"><code class="docutils literal notranslate"><span class="pre">parse_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ldp.graph.async_torch">
<span id="ldp-graph-async-torch-module"></span><h2>ldp.graph.async_torch module<a class="headerlink" href="#module-ldp.graph.async_torch" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.async_torch.AsyncTorchModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.async_torch.</span></span><span class="sig-name descname"><span class="pre">AsyncTorchModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_wait_interval:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">default_collate&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decollate_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_call_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">AsyncTorchModule.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/async_torch.html#AsyncTorchModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.async_torch.AsyncTorchModule" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncBufferedWorker</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.async_torch.async_protect_torch_call">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.async_torch.</span></span><span class="sig-name descname"><span class="pre">async_protect_torch_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_call_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_grad:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocast_dtype:</span> <span class="pre">~torch.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocast_device_type=None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="_modules/ldp/graph/async_torch.html#async_protect_torch_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.async_torch.async_protect_torch_call" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ldp.graph.common_ops">
<span id="ldp-graph-common-ops-module"></span><h2>ldp.graph.common_ops module<a class="headerlink" href="#module-ldp.graph.common_ops" title="Link to this heading">¶</a></h2>
<p>This module contains commonly-used Op implementations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.Cacheable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">Cacheable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">TResult</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#Cacheable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.Cacheable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TResult</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.Cacheable.get_result">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TResult</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#Cacheable.get_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.Cacheable.get_result" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.ConfigOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">ConfigOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.ConfigOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TConfig</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TConfig</span></code>]</p>
<p>An operation that contains a configuration object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.ConfigOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.ConfigOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id1"><span class="problematic" id="id2">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.ConfigOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TConfig</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.ConfigOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.EmbeddingOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">EmbeddingOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.EmbeddingOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a></p>
<p>A general operation for embedding text using LiteLLM.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.EmbeddingOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.EmbeddingOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id3"><span class="problematic" id="id4">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.EmbeddingOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.EmbeddingOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.FxnOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">FxnOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.FxnOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>Wrap a function for a straight through gradient approximation for all args/kwargs.</p>
<p>Basically, consider the fxn as a transform upon the inputs during the forward pass,
and propagating the same gradient for all inputs during the backward pass.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.FxnOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.FxnOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id5"><span class="problematic" id="id6">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.FxnOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.FxnOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.IdentityOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">IdentityOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.IdentityOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>An operation that simply returns the input value.</p>
<p>NOTE: this op is equivalent to FxnOp(lambda x: x).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.IdentityOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.IdentityOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id7"><span class="problematic" id="id8">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.IdentityOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.IdentityOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.LLMCallOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">LLMCallOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.LLMCallOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code>]</p>
<p>An operation for LLM calls interaction.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.LLMCallOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.LLMCallOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id9"><span class="problematic" id="id10">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.LLMCallOp.compute_logprob">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_log_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.chat.LLMModel" title="ldp.llms.chat.LLMModel"><span class="pre">LLMModel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.compute_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.LLMCallOp.compute_logprob" title="Link to this definition">¶</a></dt>
<dd><p>This method computes a Monte Carlo estimate of logprob for a given temperature.</p>
<p>It takes as input the logprob at T=1. The derivation is in Section 5.1 of the Aviary notes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.LLMCallOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_choice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">LLMModel.TOOL_CHOICE_REQUIRED</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ToolRequestMessage</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.LLMCallOp.forward" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_choice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">LLMModel.TOOL_CHOICE_REQUIRED</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Message</span></span></span></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.LLMCallOp.get_examples">
<span class="sig-name descname"><span class="pre">get_examples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.llms.html#ldp.llms.chat.LLMResult" title="ldp.llms.chat.LLMResult"><span class="pre">LLMResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.get_examples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.LLMCallOp.get_examples" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.MemoryOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">MemoryOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.MemoryOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Memory</span></code></a>]]</p>
<p>An operation for managing memory retrieval and storage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.MemoryOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.MemoryOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass for memory retrieval - goes back to item.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.MemoryOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.MemoryOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve relevant memories based on a query.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.PromptOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">PromptOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#PromptOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.PromptOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.common_ops.FxnOp" title="ldp.graph.common_ops.FxnOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">FxnOp</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
<p>An operation that formats kwargs into a prompt string.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.common_ops.StopGradOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">StopGradOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#StopGradOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.StopGradOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.common_ops.IdentityOp" title="ldp.graph.common_ops.IdentityOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">IdentityOp</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>Pass through Op that terminates gradients in the backward pass.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.common_ops.StopGradOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#StopGradOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.StopGradOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id11"><span class="problematic" id="id12">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.common_ops.async_cache">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">async_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#async_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.async_cache" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.common_ops.logsumexp">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.common_ops.</span></span><span class="sig-name descname"><span class="pre">logsumexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#logsumexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.common_ops.logsumexp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ldp.graph.gradient_estimators">
<span id="ldp-graph-gradient-estimators-module"></span><h2>ldp.graph.gradient_estimators module<a class="headerlink" href="#module-ldp.graph.gradient_estimators" title="Link to this heading">¶</a></h2>
<p>This module defines various gradient estimators that can be patched in during backward passes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.TorchParamBackwardEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">TorchParamBackwardEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#TorchParamBackwardEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.TorchParamBackwardEstimator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gradient estimator for <cite>TorchOp</cite> internal parameters.</p>
<p>This estimator computes gradients with respect to the internal parameters of a
<cite>torch.nn.Module</cite> by calling the <cite>backward</cite> method of the estimator instead of the default
<cite>backward</cite> method of <cite>TorchOp</cite>. Computed gradients are stored in the context of the operation
under the key <cite>“grad_params”</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">torch_module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch_op</span> <span class="o">=</span> <span class="n">TorchOp</span><span class="p">(</span><span class="n">torch_module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">TorchParamBackwardEstimator</span><span class="p">(</span><span class="n">torch_module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">torch_op</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">compute_grads</span><span class="p">(</span><span class="n">backward_fns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TorchOp&quot;</span><span class="p">:</span> <span class="n">estimator</span><span class="o">.</span><span class="n">backward</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This estimator is only compatible with <cite>TorchOp</cite> operations.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.TorchParamBackwardEstimator.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#TorchParamBackwardEstimator.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.TorchParamBackwardEstimator.backward" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.assign_constant_grads">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">assign_constant_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#assign_constant_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.assign_constant_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.assign_default_grads">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">assign_default_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_grads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradInType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_grad_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#assign_default_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.assign_default_grads" title="Link to this definition">¶</a></dt>
<dd><p>Sets a default value of default_grad_val for every element in input_grads.</p>
<p>Example:
- input_kwargs = {“a”: {“b”: 1, “c”: 2}},
- input_grad_kwargs = {“a”: {“b”: 0.1}}
Output: input_grads[1] = {“a”: {“b”: 0.1, “c”: default_grad_val}}</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing the updated input_grad_args and</dt><dd><p>input_grad_kwargs with default values assigned where necessary.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>GradInType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.llm_straight_through_estimator">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">llm_straight_through_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#llm_straight_through_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.llm_straight_through_estimator" title="Link to this definition">¶</a></dt>
<dd><p>Straight-through for an LLM: descend into the config, but not msgs/tools/tool_calls.</p>
<p>See LLMCallOp.backward() for more details on this choice.
Don’t bother checking that input_args/input_kwargs have the right structure,
since compute_grads() will raise if not.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.stop_grad">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">stop_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#stop_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.stop_grad" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.straight_through_estimator">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">straight_through_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">descend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#straight_through_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.straight_through_estimator" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.gradient_estimators.zero_estimator">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.gradient_estimators.</span></span><span class="sig-name descname"><span class="pre">zero_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/gradient_estimators.html#zero_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.gradient_estimators.zero_estimator" title="Link to this definition">¶</a></dt>
<dd><p>Sets the gradient of all inputs to zero.</p>
<p>Note that this is not the same as truncating the compute graph (stop_grad),
since upstream nodes can still optimize their logprobs. The zero estimator
the unbiased choice if we have no information about the gradient.</p>
</dd></dl>

</section>
<section id="module-ldp.graph.loss_ops">
<span id="ldp-graph-loss-ops-module"></span><h2>ldp.graph.loss_ops module<a class="headerlink" href="#module-ldp.graph.loss_ops" title="Link to this heading">¶</a></h2>
<p>This module contains loss Op implementations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.loss_ops.MSELossOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.loss_ops.</span></span><span class="sig-name descname"><span class="pre">MSELossOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.loss_ops.MSELossOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.loss_ops.MSELossOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.loss_ops.MSELossOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id13"><span class="problematic" id="id14">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.loss_ops.MSELossOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.loss_ops.MSELossOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-ldp.graph.memory">
<span id="ldp-graph-memory-module"></span><h2>ldp.graph.memory module<a class="headerlink" href="#module-ldp.graph.memory" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.memory.</span></span><span class="sig-name descname"><span class="pre">Memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonValue</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Input:</span> <span class="pre">{input}\nOutput:</span> <span class="pre">{output}\nValue:</span> <span class="pre">{value}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.Memory" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>A single memory about an input, output, and value tuple.</p>
<p>A memory is a record of an input, output, and resulting value. Typically used
for prompting a language model. Or, it could be about a whole forward pass where
the input is the observation and the output is the action taken.
The query is optionally different and used for
retrieving the memory. For example, it could be much larger because it won’t
be formatted in the resulting prompt.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.ensure_query">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensure_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory.ensure_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.Memory.ensure_query" title="Link to this definition">¶</a></dt>
<dd><p>Copy input to match the query if input is None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.from_ops">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mem_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.common_ops.MemoryOp" title="ldp.graph.common_ops.MemoryOp"><span class="pre">MemoryOp</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mem_call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory.from_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.Memory.from_ops" title="Link to this definition">¶</a></dt>
<dd><p>Create from a MemoryOp, output Op, and their call IDs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.input">
<span class="sig-name descname"><span class="pre">input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.input" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">JsonValue</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.metadata" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'input':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Some</span> <span class="pre">input</span> <span class="pre">(e.g.</span> <span class="pre">prompt</span> <span class="pre">to</span> <span class="pre">LLM,</span> <span class="pre">observation).</span> <span class="pre">If</span> <span class="pre">None</span> <span class="pre">(default),</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">is</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">the</span> <span class="pre">query.'),</span> <span class="pre">'metadata':</span> <span class="pre">FieldInfo(annotation=JsonValue,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict,</span> <span class="pre">description='Optional</span> <span class="pre">JSON</span> <span class="pre">metadata</span> <span class="pre">to</span> <span class="pre">store</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">memory.</span> <span class="pre">An</span> <span class="pre">example</span> <span class="pre">is</span> <span class="pre">storing</span> <span class="pre">information</span> <span class="pre">an</span> <span class="pre">optimizer</span> <span class="pre">can</span> <span class="pre">use</span> <span class="pre">at</span> <span class="pre">training</span> <span class="pre">time.'),</span> <span class="pre">'output':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='Some</span> <span class="pre">output</span> <span class="pre">(e.g.</span> <span class="pre">tool</span> <span class="pre">selection).'),</span> <span class="pre">'query':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='String</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">embedded</span> <span class="pre">into</span> <span class="pre">a</span> <span class="pre">retrieval</span> <span class="pre">key</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">memory</span> <span class="pre">index.'),</span> <span class="pre">'run_id':</span> <span class="pre">FieldInfo(annotation=Union[UUID,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Associate</span> <span class="pre">run_id</span> <span class="pre">for</span> <span class="pre">debugging</span> <span class="pre">purposes</span> <span class="pre">to</span> <span class="pre">trace</span> <span class="pre">which</span> <span class="pre">forward</span> <span class="pre">pass</span> <span class="pre">generated</span> <span class="pre">the</span> <span class="pre">memory.'),</span> <span class="pre">'template':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='Input:</span> <span class="pre">{input}\nOutput:</span> <span class="pre">{output}\nValue:</span> <span class="pre">{value}'),</span> <span class="pre">'value':</span> <span class="pre">FieldInfo(annotation=Union[float,</span> <span class="pre">str],</span> <span class="pre">required=True,</span> <span class="pre">description=&quot;Measure</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">output's</span> <span class="pre">quality</span> <span class="pre">(e.g.</span> <span class="pre">loss).&quot;)}</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.output">
<span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.query">
<span class="sig-name descname"><span class="pre">query</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.query" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.run_id">
<span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.template">
<span class="sig-name descname"><span class="pre">template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.template" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.Memory.value">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.memory.Memory.value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.memory.</span></span><span class="sig-name descname"><span class="pre">MemoryModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.MemoryModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TIndex</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A collection of memories with retrieval.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.DEFAULT_MEMORY_MATCHES">
<span class="sig-name descname"><span class="pre">DEFAULT_MEMORY_MATCHES</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.DEFAULT_MEMORY_MATCHES" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.add_memory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.add_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.MemoryModel.add_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.embedding_model">
<span class="sig-name descname"><span class="pre">embedding_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.embedding_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.enforce_empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enforce_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.enforce_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.MemoryModel.enforce_empty" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.get_memory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.get_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.MemoryModel.get_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.memories">
<span class="sig-name descname"><span class="pre">memories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.memories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'arbitrary_types_allowed':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'embedding_model':</span> <span class="pre">FieldInfo(annotation=EmbeddingModel,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;),</span> <span class="pre">'memories':</span> <span class="pre">FieldInfo(annotation=dict[int,</span> <span class="pre">Memory],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict)}</span></em><a class="headerlink" href="#ldp.graph.memory.MemoryModel.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.model_post_init">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ldp.graph.memory.MemoryModel.model_post_init" title="Link to this definition">¶</a></dt>
<dd><p>This function is meant to behave like a BaseModel method to initialise private attributes.</p>
<p>It takes context as an argument since that’s what pydantic-core passes when calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The BaseModel instance.</p></li>
<li><p><strong>context</strong> – The context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.MemoryModel.safe_access_index">
<span class="sig-name descname"><span class="pre">safe_access_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">TIndex</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.safe_access_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.MemoryModel.safe_access_index" title="Link to this definition">¶</a></dt>
<dd><p>Get the internal Index under the protection of an internal Lock.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.memory.</span></span><span class="sig-name descname"><span class="pre">MemoryModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TIndex</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A collection of memories with retrieval.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">DEFAULT_MEMORY_MATCHES</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#id15" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.add_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">embedding_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></em><a class="headerlink" href="#id17" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enforce_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.enforce_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.get_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">memories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id20" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#id21" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'arbitrary_types_allowed':</span> <span class="pre">True}</span></em><a class="headerlink" href="#id22" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'embedding_model':</span> <span class="pre">FieldInfo(annotation=EmbeddingModel,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;),</span> <span class="pre">'memories':</span> <span class="pre">FieldInfo(annotation=dict[int,</span> <span class="pre">Memory],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict)}</span></em><a class="headerlink" href="#id23" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id24" title="Link to this definition">¶</a></dt>
<dd><p>This function is meant to behave like a BaseModel method to initialise private attributes.</p>
<p>It takes context as an argument since that’s what pydantic-core passes when calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The BaseModel instance.</p></li>
<li><p><strong>context</strong> – The context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">safe_access_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">TIndex</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.safe_access_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition">¶</a></dt>
<dd><p>Get the internal Index under the protection of an internal Lock.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.memory.UIndexMemoryModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.memory.</span></span><span class="sig-name descname"><span class="pre">UIndexMemoryModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#UIndexMemoryModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.memory.UIndexMemoryModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MemoryModel[Index]</span></code></p>
<p>Memory model using a U-Search index.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.UIndexMemoryModel.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.memory.UIndexMemoryModel.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.UIndexMemoryModel.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'arbitrary_types_allowed':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.graph.memory.UIndexMemoryModel.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.memory.UIndexMemoryModel.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'embedding_model':</span> <span class="pre">FieldInfo(annotation=EmbeddingModel,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;),</span> <span class="pre">'memories':</span> <span class="pre">FieldInfo(annotation=dict[int,</span> <span class="pre">Memory],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict)}</span></em><a class="headerlink" href="#ldp.graph.memory.UIndexMemoryModel.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.memory.UIndexMemoryModel.model_post_init">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ldp.graph.memory.UIndexMemoryModel.model_post_init" title="Link to this definition">¶</a></dt>
<dd><p>We need to both initialize private attributes and call the user-defined model_post_init
method.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ldp.graph.op_utils">
<span id="ldp-graph-op-utils-module"></span><h2>ldp.graph.op_utils module<a class="headerlink" href="#module-ldp.graph.op_utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">CallID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UUID</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.CallID" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.fwd_id">
<span class="sig-name descname"><span class="pre">fwd_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.op_utils.CallID.fwd_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.op_utils.CallID.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.op_utils.CallID.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'fwd_id':</span> <span class="pre">FieldInfo(annotation=UUID,</span> <span class="pre">required=True),</span> <span class="pre">'run_id':</span> <span class="pre">FieldInfo(annotation=UUID,</span> <span class="pre">required=True)}</span></em><a class="headerlink" href="#ldp.graph.op_utils.CallID.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.run_id">
<span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.op_utils.CallID.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.serialize_uuid">
<span class="sig-name descname"><span class="pre">serialize_uuid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID.serialize_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.CallID.serialize_uuid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.op_utils.CallID.validate_uuid">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_uuid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">UUID</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID.validate_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.CallID.validate_uuid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.compute_graph">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">compute_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">UUID</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#compute_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.compute_graph" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a compute graph by setting a run ID.</p>
<p>If a run ID is already set (i.e. we are already inside a
get_run_id() context), then the existing run ID is returned.
Otherwise, a new UUID is created.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.get_call_id">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">get_call_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_call_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.get_call_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the current call ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.get_run_id">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">get_run_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">UUID</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_run_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.get_run_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the current run ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.get_training_mode">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">get_training_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_training_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.get_training_mode" title="Link to this definition">¶</a></dt>
<dd><p>Get the current training mode.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.op_call">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">op_call</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#op_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.op_call" title="Link to this definition">¶</a></dt>
<dd><p>Decorate an op call with a call ID.</p>
<p>If a call ID is already set (i.e. we are already inside an op call),
then the existing call ID is returned.
Otherwise, a new UUID is created.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_utils.set_training_mode">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.op_utils.</span></span><span class="sig-name descname"><span class="pre">set_training_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#set_training_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_utils.set_training_mode" title="Link to this definition">¶</a></dt>
<dd><p>Set the training mode.</p>
</dd></dl>

</section>
<section id="module-ldp.graph.ops">
<span id="ldp-graph-ops-module"></span><h2>ldp.graph.ops module<a class="headerlink" href="#module-ldp.graph.ops" title="Link to this heading">¶</a></h2>
<p>This module defines the Op class and its helper classes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.ops.Op">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.ops.</span></span><span class="sig-name descname"><span class="pre">Op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>An operation that is ‘differentiable’ and can be used in an optimizer.</p>
<p>Think torch.autograd.Function that can also be applied to non-differentiable
operations like prompt template formatting or Python function calls.</p>
<p>These form a forward computation graph when composed with other Ops via
__call__. In training mode, this graph is constructed dynamically.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.backward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id26"><span class="problematic" id="id27">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.clear_ctx">
<span class="sig-name descname"><span class="pre">clear_ctx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.clear_ctx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.clear_ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.ctx">
<span class="sig-name descname"><span class="pre">ctx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></em><a class="headerlink" href="#ldp.graph.ops.Op.ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.get_call_ids">
<span class="sig-name descname"><span class="pre">get_call_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">UUID</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.get_call_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.get_call_ids" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.get_input_grads">
<span class="sig-name descname"><span class="pre">get_input_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.get_input_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.get_input_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.ops.Op.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.Op.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.Op.set_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.ops.</span></span><span class="sig-name descname"><span class="pre">OpCtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.clear_contexts">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_contexts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.clear_contexts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx.clear_contexts" title="Link to this definition">¶</a></dt>
<dd><p>Clear the data in all contexts. If op_names is provided, only clear those contexts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#ldp.graph.ops.OpCtx.data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id:</span> <span class="pre">~ldp.graph.op_utils.CallID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default:</span> <span class="pre">~typing.Any</span> <span class="pre">=</span> <span class="pre">&lt;object</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx.get" title="Link to this definition">¶</a></dt>
<dd><p>Get an attribute with an optional default, emulating dict.get.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.get_input_grads">
<span class="sig-name descname"><span class="pre">get_input_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get_input_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx.get_input_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.get_or_create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_or_create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get_or_create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx.get_or_create" title="Link to this definition">¶</a></dt>
<dd><p>Return an OpCtx corresponding to the Op with the given name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.ops.OpCtx.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.ops.OpCtx.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'data':</span> <span class="pre">FieldInfo(annotation=dict,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;,</span> <span class="pre">description='Maps</span> <span class="pre">run_id</span> <span class="pre">-&gt;</span> <span class="pre">(fwd_id,</span> <span class="pre">key)</span> <span class="pre">-&gt;</span> <span class="pre">value.</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">excluded</span> <span class="pre">from</span> <span class="pre">model_dump()</span> <span class="pre">etc</span> <span class="pre">because</span> <span class="pre">we</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">use</span> <span class="pre">Pydantic</span> <span class="pre">to</span> <span class="pre">persist</span> <span class="pre">context</span> <span class="pre">information.</span> <span class="pre">That</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">done</span> <span class="pre">via</span> <span class="pre">the</span> <span class="pre">DB</span> <span class="pre">backend</span> <span class="pre">instead.</span> <span class="pre">OpCtx</span> <span class="pre">will</span> <span class="pre">serialize</span> <span class="pre">op_name,</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">enough</span> <span class="pre">to</span> <span class="pre">rehydrate</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">DB.',</span> <span class="pre">exclude=True),</span> <span class="pre">'op_name':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True)}</span></em><a class="headerlink" href="#ldp.graph.ops.OpCtx.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.model_post_init">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ldp.graph.ops.OpCtx.model_post_init" title="Link to this definition">¶</a></dt>
<dd><p>This function is meant to behave like a BaseModel method to initialise private attributes.</p>
<p>It takes context as an argument since that’s what pydantic-core passes when calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The BaseModel instance.</p></li>
<li><p><strong>context</strong> – The context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.op_name">
<span class="sig-name descname"><span class="pre">op_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.ops.OpCtx.op_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpCtx.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpCtx.update" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.ops.</span></span><span class="sig-name descname"><span class="pre">OpResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_class_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>Result of a forward pass, used in the compute graph.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.compute_grads">
<span class="sig-name descname"><span class="pre">compute_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">BackwardsType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.compute_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.compute_grads" title="Link to this definition">¶</a></dt>
<dd><p>Compute the gradient of the backward graph in-place.</p>
<p>This executes topological traversal.
It is up to the Op to:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>define the backward computation</p></li>
<li><p>store internal gradients for optimizer updates.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.ctx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ctx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></em><a class="headerlink" href="#ldp.graph.ops.OpResult.ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.from_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.get_compute_graph">
<span class="sig-name descname"><span class="pre">get_compute_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DiGraph</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.get_compute_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.get_compute_graph" title="Link to this definition">¶</a></dt>
<dd><p>Construct a directed graph of the compute graph that led to this OpResult.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backward</strong> – If True (default), constructs the backwards graph in which outputs
point to inputs. If False, constructs the forward call graph.
For most cases (e.g. backprop), backward=True is desirable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A digraph in which nodes are OpResults.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tree.Structure</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.ops.OpResult.grad" title="Link to this definition">¶</a></dt>
<dd><p>Returns <cite>d ln(P_{compute_graph}) / d self</cite> or None if gradients have not been computed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.inputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.ops.OpResult.inputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.logprob">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logprob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.ops.OpResult.logprob" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.op_class">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">op_class</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.ops.OpResult.op_class" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.run_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.ops.OpResult.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.traverse">
<span class="sig-name descname"><span class="pre">traverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">topological_order:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">filter_fn:</span> <span class="pre">~collections.abc.Callable[[~ldp.graph.ops.OpResult],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">OpResult.&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.traverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.traverse" title="Link to this definition">¶</a></dt>
<dd><p>Traverse the compute graph that led to this OpResult.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topological_order</strong> – If True, traverse the backwards graph in topological
order. This requires having the whole graph in memory. If False,
traverse the backwards graph in depth-first order. This can be done
lazily and is useful if we are trying to hydrate the graph node-by-node.
Most user-facing cases can leave this as True. Defaults to True.</p></li>
<li><p><strong>filter_fn</strong> – Will only yield nodes that pass this filter function. Note that
nodes that fail will still be traversed.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>An iterator over the nodes of this graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ops.OpResult.unwrap_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unwrap_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.unwrap_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.OpResult.unwrap_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.ops.resolve_fully_qualified_name">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.ops.</span></span><span class="sig-name descname"><span class="pre">resolve_fully_qualified_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#resolve_fully_qualified_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ops.resolve_fully_qualified_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ldp.graph.torch_ops">
<span id="ldp-graph-torch-ops-module"></span><h2>ldp.graph.torch_ops module<a class="headerlink" href="#module-ldp.graph.torch_ops" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.torch_ops.TorchOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.torch_ops.</span></span><span class="sig-name descname"><span class="pre">TorchOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/torch_ops.html#TorchOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.torch_ops.TorchOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
<p>An operation that wraps a PyTorch module.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.torch_ops.TorchOp.CTX_TENSOR_INPUT_KEY">
<span class="sig-name descname"><span class="pre">CTX_TENSOR_INPUT_KEY</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tensor_input'</span></em><a class="headerlink" href="#ldp.graph.torch_ops.TorchOp.CTX_TENSOR_INPUT_KEY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.torch_ops.TorchOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/torch_ops.html#TorchOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.torch_ops.TorchOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id28"><span class="problematic" id="id29">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.torch_ops.TorchOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/ldp/graph/torch_ops.html#TorchOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.torch_ops.TorchOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.torch_ops.store_tensor_inputs">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.torch_ops.</span></span><span class="sig-name descname"><span class="pre">store_tensor_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/torch_ops.html#store_tensor_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.torch_ops.store_tensor_inputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ldp.graph">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ldp.graph" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.CallID">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">CallID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">UUID</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.CallID" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.CallID.fwd_id">
<span class="sig-name descname"><span class="pre">fwd_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.CallID.fwd_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.CallID.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.CallID.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.CallID.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.CallID.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.CallID.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'fwd_id':</span> <span class="pre">FieldInfo(annotation=UUID,</span> <span class="pre">required=True),</span> <span class="pre">'run_id':</span> <span class="pre">FieldInfo(annotation=UUID,</span> <span class="pre">required=True)}</span></em><a class="headerlink" href="#ldp.graph.CallID.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.CallID.run_id">
<span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.CallID.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.CallID.serialize_uuid">
<span class="sig-name descname"><span class="pre">serialize_uuid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID.serialize_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.CallID.serialize_uuid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.CallID.validate_uuid">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_uuid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">UUID</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#CallID.validate_uuid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.CallID.validate_uuid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.ConfigOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">ConfigOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ConfigOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TConfig</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TConfig</span></code>]</p>
<p>An operation that contains a configuration object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ConfigOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ConfigOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id30"><span class="problematic" id="id31">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.ConfigOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TConfig</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#ConfigOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.ConfigOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.EmbeddingOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">EmbeddingOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.EmbeddingOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a></p>
<p>A general operation for embedding text using LiteLLM.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.EmbeddingOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.EmbeddingOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id32"><span class="problematic" id="id33">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.EmbeddingOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#EmbeddingOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.EmbeddingOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.FxnOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">FxnOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.FxnOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>Wrap a function for a straight through gradient approximation for all args/kwargs.</p>
<p>Basically, consider the fxn as a transform upon the inputs during the forward pass,
and propagating the same gradient for all inputs during the backward pass.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.FxnOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.FxnOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id34"><span class="problematic" id="id35">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.FxnOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#FxnOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.FxnOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.IdentityOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">IdentityOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.IdentityOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>An operation that simply returns the input value.</p>
<p>NOTE: this op is equivalent to FxnOp(lambda x: x).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.IdentityOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.IdentityOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id36"><span class="problematic" id="id37">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.IdentityOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#IdentityOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.IdentityOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.LLMCallOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">LLMCallOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.LLMCallOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code>]</p>
<p>An operation for LLM calls interaction.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.LLMCallOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.LLMCallOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id38"><span class="problematic" id="id39">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.LLMCallOp.compute_logprob">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_log_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.chat.LLMModel" title="ldp.llms.chat.LLMModel"><span class="pre">LLMModel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.compute_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.LLMCallOp.compute_logprob" title="Link to this definition">¶</a></dt>
<dd><p>This method computes a Monte Carlo estimate of logprob for a given temperature.</p>
<p>It takes as input the logprob at T=1. The derivation is in Section 5.1 of the Aviary notes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.LLMCallOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_choice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">LLMModel.TOOL_CHOICE_REQUIRED</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ToolRequestMessage</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.LLMCallOp.forward" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tool_choice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">LLMModel.TOOL_CHOICE_REQUIRED</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Message</span></span></span></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.LLMCallOp.get_examples">
<span class="sig-name descname"><span class="pre">get_examples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.llms.html#ldp.llms.chat.LLMResult" title="ldp.llms.chat.LLMResult"><span class="pre">LLMResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#LLMCallOp.get_examples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.LLMCallOp.get_examples" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.MSELossOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">MSELossOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MSELossOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MSELossOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StructureKV</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">V</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MSELossOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id40"><span class="problematic" id="id41">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MSELossOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/ldp/graph/loss_ops.html#MSELossOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MSELossOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.Memory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">Memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonValue</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Input:</span> <span class="pre">{input}\nOutput:</span> <span class="pre">{output}\nValue:</span> <span class="pre">{value}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Memory" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>A single memory about an input, output, and value tuple.</p>
<p>A memory is a record of an input, output, and resulting value. Typically used
for prompting a language model. Or, it could be about a whole forward pass where
the input is the observation and the output is the action taken.
The query is optionally different and used for
retrieving the memory. For example, it could be much larger because it won’t
be formatted in the resulting prompt.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Memory.ensure_query">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensure_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory.ensure_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Memory.ensure_query" title="Link to this definition">¶</a></dt>
<dd><p>Copy input to match the query if input is None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Memory.from_ops">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mem_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.MemoryOp" title="ldp.graph.MemoryOp"><span class="pre">MemoryOp</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mem_call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.Op" title="ldp.graph.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#Memory.from_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Memory.from_ops" title="Link to this definition">¶</a></dt>
<dd><p>Create from a MemoryOp, output Op, and their call IDs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.input">
<span class="sig-name descname"><span class="pre">input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.Memory.input" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">JsonValue</span></em><a class="headerlink" href="#ldp.graph.Memory.metadata" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.Memory.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.Memory.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'input':</span> <span class="pre">FieldInfo(annotation=Union[str,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Some</span> <span class="pre">input</span> <span class="pre">(e.g.</span> <span class="pre">prompt</span> <span class="pre">to</span> <span class="pre">LLM,</span> <span class="pre">observation).</span> <span class="pre">If</span> <span class="pre">None</span> <span class="pre">(default),</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">is</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">the</span> <span class="pre">query.'),</span> <span class="pre">'metadata':</span> <span class="pre">FieldInfo(annotation=JsonValue,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict,</span> <span class="pre">description='Optional</span> <span class="pre">JSON</span> <span class="pre">metadata</span> <span class="pre">to</span> <span class="pre">store</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">memory.</span> <span class="pre">An</span> <span class="pre">example</span> <span class="pre">is</span> <span class="pre">storing</span> <span class="pre">information</span> <span class="pre">an</span> <span class="pre">optimizer</span> <span class="pre">can</span> <span class="pre">use</span> <span class="pre">at</span> <span class="pre">training</span> <span class="pre">time.'),</span> <span class="pre">'output':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='Some</span> <span class="pre">output</span> <span class="pre">(e.g.</span> <span class="pre">tool</span> <span class="pre">selection).'),</span> <span class="pre">'query':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True,</span> <span class="pre">description='String</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">embedded</span> <span class="pre">into</span> <span class="pre">a</span> <span class="pre">retrieval</span> <span class="pre">key</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">memory</span> <span class="pre">index.'),</span> <span class="pre">'run_id':</span> <span class="pre">FieldInfo(annotation=Union[UUID,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Associate</span> <span class="pre">run_id</span> <span class="pre">for</span> <span class="pre">debugging</span> <span class="pre">purposes</span> <span class="pre">to</span> <span class="pre">trace</span> <span class="pre">which</span> <span class="pre">forward</span> <span class="pre">pass</span> <span class="pre">generated</span> <span class="pre">the</span> <span class="pre">memory.'),</span> <span class="pre">'template':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=False,</span> <span class="pre">default='Input:</span> <span class="pre">{input}\nOutput:</span> <span class="pre">{output}\nValue:</span> <span class="pre">{value}'),</span> <span class="pre">'value':</span> <span class="pre">FieldInfo(annotation=Union[float,</span> <span class="pre">str],</span> <span class="pre">required=True,</span> <span class="pre">description=&quot;Measure</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">output's</span> <span class="pre">quality</span> <span class="pre">(e.g.</span> <span class="pre">loss).&quot;)}</span></em><a class="headerlink" href="#ldp.graph.Memory.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.output">
<span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.Memory.output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.query">
<span class="sig-name descname"><span class="pre">query</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.Memory.query" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.run_id">
<span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.Memory.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.template">
<span class="sig-name descname"><span class="pre">template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.Memory.template" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Memory.value">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.Memory.value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">MemoryModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TIndex</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A collection of memories with retrieval.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.DEFAULT_MEMORY_MATCHES">
<span class="sig-name descname"><span class="pre">DEFAULT_MEMORY_MATCHES</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#ldp.graph.MemoryModel.DEFAULT_MEMORY_MATCHES" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.add_memory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.add_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryModel.add_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.embedding_model">
<span class="sig-name descname"><span class="pre">embedding_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.llms.html#ldp.llms.embeddings.EmbeddingModel" title="ldp.llms.embeddings.EmbeddingModel"><span class="pre">EmbeddingModel</span></a></em><a class="headerlink" href="#ldp.graph.MemoryModel.embedding_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.enforce_empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enforce_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.enforce_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryModel.enforce_empty" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.get_memory">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.get_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryModel.get_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.memories">
<span class="sig-name descname"><span class="pre">memories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.MemoryModel.memories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.MemoryModel.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'arbitrary_types_allowed':</span> <span class="pre">True}</span></em><a class="headerlink" href="#ldp.graph.MemoryModel.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'embedding_model':</span> <span class="pre">FieldInfo(annotation=EmbeddingModel,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;),</span> <span class="pre">'memories':</span> <span class="pre">FieldInfo(annotation=dict[int,</span> <span class="pre">Memory],</span> <span class="pre">required=False,</span> <span class="pre">default_factory=dict)}</span></em><a class="headerlink" href="#ldp.graph.MemoryModel.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.model_post_init">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ldp.graph.MemoryModel.model_post_init" title="Link to this definition">¶</a></dt>
<dd><p>This function is meant to behave like a BaseModel method to initialise private attributes.</p>
<p>It takes context as an argument since that’s what pydantic-core passes when calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The BaseModel instance.</p></li>
<li><p><strong>context</strong> – The context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryModel.safe_access_index">
<span class="sig-name descname"><span class="pre">safe_access_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">TIndex</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/memory.html#MemoryModel.safe_access_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryModel.safe_access_index" title="Link to this definition">¶</a></dt>
<dd><p>Get the internal Index under the protection of an internal Lock.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.MemoryOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">MemoryOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><code class="xref py py-class docutils literal notranslate"><span class="pre">Op</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Memory</span></code></a>]]</p>
<p>An operation for managing memory retrieval and storage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryOp.backward">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryOp.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass for memory retrieval - goes back to item.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.MemoryOp.forward">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.memory.Memory" title="ldp.graph.memory.Memory"><span class="pre">Memory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#MemoryOp.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.MemoryOp.forward" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve relevant memories based on a query.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.Op">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">Op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>An operation that is ‘differentiable’ and can be used in an optimizer.</p>
<p>Think torch.autograd.Function that can also be applied to non-differentiable
operations like prompt template formatting or Python function calls.</p>
<p>These form a forward computation graph when composed with other Ops via
__call__. In training mode, this graph is constructed dynamically.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.backward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.OpCtx" title="ldp.graph.OpCtx"><span class="pre">OpCtx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ResultOrValue</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.backward" title="Link to this definition">¶</a></dt>
<dd><p>Backward pass of the Op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Context that was used during the forward pass.</p></li>
<li><p><strong>input_args</strong> – Variable-length input arguments passed to forward, i.e.
via <a href="#id42"><span class="problematic" id="id43">*</span></a>args.</p></li>
<li><p><strong>input_kwargs</strong> – All other arguments passed to forward pass.</p></li>
<li><p><strong>grad_output</strong> – A list of backpropagated gradients from each consumer
of the output of the forward pass. It is up to the implementation
to decide how to aggregate these gradients (e.g. in most cases summing).</p></li>
<li><p><strong>call_id</strong> – Call ID of the forward pass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>d log(p) / d input</cite> for each input to the forward pass.</dt><dd><p>It should include gradients for all input positional and keyword
arguments. Set to None for gradients that should terminate.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.clear_ctx">
<span class="sig-name descname"><span class="pre">clear_ctx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.clear_ctx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.clear_ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Op.ctx">
<span class="sig-name descname"><span class="pre">ctx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></em><a class="headerlink" href="#ldp.graph.Op.ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass of the Op. Must accept call_id as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Depending on this Op’s purpose, the return may be considered an action</dt><dd><p>(e.g. a tool call) or it may not (e.g. a loss calculation).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.get_call_ids">
<span class="sig-name descname"><span class="pre">get_call_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">UUID</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.get_call_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.get_call_ids" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.get_input_grads">
<span class="sig-name descname"><span class="pre">get_input_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.get_input_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.get_input_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.Op.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.Op.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.Op.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#Op.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.Op.set_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.OpCtx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">OpCtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.clear_contexts">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_contexts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.clear_contexts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx.clear_contexts" title="Link to this definition">¶</a></dt>
<dd><p>Clear the data in all contexts. If op_names is provided, only clear those contexts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#ldp.graph.OpCtx.data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id:</span> <span class="pre">~ldp.graph.op_utils.CallID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default:</span> <span class="pre">~typing.Any</span> <span class="pre">=</span> <span class="pre">&lt;object</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx.get" title="Link to this definition">¶</a></dt>
<dd><p>Get an attribute with an optional default, emulating dict.get.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.get_input_grads">
<span class="sig-name descname"><span class="pre">get_input_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.CallID" title="ldp.graph.CallID"><span class="pre">CallID</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GradInType</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get_input_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx.get_input_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.get_or_create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_or_create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.get_or_create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx.get_or_create" title="Link to this definition">¶</a></dt>
<dd><p>Return an OpCtx corresponding to the Op with the given name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.OpCtx.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.graph.OpCtx.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'data':</span> <span class="pre">FieldInfo(annotation=dict,</span> <span class="pre">required=False,</span> <span class="pre">default_factory=&lt;lambda&gt;,</span> <span class="pre">description='Maps</span> <span class="pre">run_id</span> <span class="pre">-&gt;</span> <span class="pre">(fwd_id,</span> <span class="pre">key)</span> <span class="pre">-&gt;</span> <span class="pre">value.</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">excluded</span> <span class="pre">from</span> <span class="pre">model_dump()</span> <span class="pre">etc</span> <span class="pre">because</span> <span class="pre">we</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">use</span> <span class="pre">Pydantic</span> <span class="pre">to</span> <span class="pre">persist</span> <span class="pre">context</span> <span class="pre">information.</span> <span class="pre">That</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">done</span> <span class="pre">via</span> <span class="pre">the</span> <span class="pre">DB</span> <span class="pre">backend</span> <span class="pre">instead.</span> <span class="pre">OpCtx</span> <span class="pre">will</span> <span class="pre">serialize</span> <span class="pre">op_name,</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">enough</span> <span class="pre">to</span> <span class="pre">rehydrate</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">DB.',</span> <span class="pre">exclude=True),</span> <span class="pre">'op_name':</span> <span class="pre">FieldInfo(annotation=str,</span> <span class="pre">required=True)}</span></em><a class="headerlink" href="#ldp.graph.OpCtx.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.model_post_init">
<span class="sig-name descname"><span class="pre">model_post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ldp.graph.OpCtx.model_post_init" title="Link to this definition">¶</a></dt>
<dd><p>This function is meant to behave like a BaseModel method to initialise private attributes.</p>
<p>It takes context as an argument since that’s what pydantic-core passes when calling it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The BaseModel instance.</p></li>
<li><p><strong>context</strong> – The context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.op_name">
<span class="sig-name descname"><span class="pre">op_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ldp.graph.OpCtx.op_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpCtx.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpCtx.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpCtx.update" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.OpResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">OpResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">call_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_class_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOutput</span></code>]</p>
<p>Result of a forward pass, used in the compute graph.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.compute_grads">
<span class="sig-name descname"><span class="pre">compute_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tree.Structure</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">BackwardsType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.compute_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.compute_grads" title="Link to this definition">¶</a></dt>
<dd><p>Compute the gradient of the backward graph in-place.</p>
<p>This executes topological traversal.
It is up to the Op to:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>define the backward computation</p></li>
<li><p>store internal gradients for optimizer updates.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.ctx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ctx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpCtx" title="ldp.graph.ops.OpCtx"><span class="pre">OpCtx</span></a></em><a class="headerlink" href="#ldp.graph.OpResult.ctx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.from_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.get_compute_graph">
<span class="sig-name descname"><span class="pre">get_compute_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DiGraph</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.get_compute_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.get_compute_graph" title="Link to this definition">¶</a></dt>
<dd><p>Construct a directed graph of the compute graph that led to this OpResult.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backward</strong> – If True (default), constructs the backwards graph in which outputs
point to inputs. If False, constructs the forward call graph.
For most cases (e.g. backprop), backward=True is desirable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A digraph in which nodes are OpResults.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tree.Structure</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.OpResult.grad" title="Link to this definition">¶</a></dt>
<dd><p>Returns <cite>d ln(P_{compute_graph}) / d self</cite> or None if gradients have not been computed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.inputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.OpResult.inputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.logprob">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logprob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.graph.OpResult.logprob" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.op_class">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">op_class</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.Op" title="ldp.graph.ops.Op"><span class="pre">Op</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.graph.OpResult.op_class" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.graph.OpResult.run_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">UUID</span></em><a class="headerlink" href="#ldp.graph.OpResult.run_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.traverse">
<span class="sig-name descname"><span class="pre">traverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">topological_order:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">filter_fn:</span> <span class="pre">~collections.abc.Callable[[~ldp.graph.ops.OpResult],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">OpResult.&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.traverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.traverse" title="Link to this definition">¶</a></dt>
<dd><p>Traverse the compute graph that led to this OpResult.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topological_order</strong> – If True, traverse the backwards graph in topological
order. This requires having the whole graph in memory. If False,
traverse the backwards graph in depth-first order. This can be done
lazily and is useful if we are trying to hydrate the graph node-by-node.
Most user-facing cases can leave this as True. Defaults to True.</p></li>
<li><p><strong>filter_fn</strong> – Will only yield nodes that pass this filter function. Note that
nodes that fail will still be traversed.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>An iterator over the nodes of this graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.graph.OpResult.unwrap_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unwrap_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TOutput</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TOutput</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TOutput</span></span></span><a class="reference internal" href="_modules/ldp/graph/ops.html#OpResult.unwrap_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.OpResult.unwrap_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.graph.PromptOp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">PromptOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/graph/common_ops.html#PromptOp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.PromptOp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.graph.common_ops.FxnOp" title="ldp.graph.common_ops.FxnOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">FxnOp</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
<p>An operation that formats kwargs into a prompt string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.compute_graph">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">compute_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><span class="pre">UUID</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#compute_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.compute_graph" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a compute graph by setting a run ID.</p>
<p>If a run ID is already set (i.e. we are already inside a
get_run_id() context), then the existing run ID is returned.
Otherwise, a new UUID is created.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.get_call_id">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">get_call_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_call_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.get_call_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the current call ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.get_run_id">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">get_run_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">UUID</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_run_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.get_run_id" title="Link to this definition">¶</a></dt>
<dd><p>Get the current run ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.get_training_mode">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">get_training_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#get_training_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.get_training_mode" title="Link to this definition">¶</a></dt>
<dd><p>Get the current training mode.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.op_call">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">op_call</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">AsyncIterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.graph.op_utils.CallID" title="ldp.graph.op_utils.CallID"><span class="pre">CallID</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#op_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.op_call" title="Link to this definition">¶</a></dt>
<dd><p>Decorate an op call with a call ID.</p>
<p>If a call ID is already set (i.e. we are already inside an op call),
then the existing call ID is returned.
Otherwise, a new UUID is created.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.graph.set_training_mode">
<span class="sig-prename descclassname"><span class="pre">ldp.graph.</span></span><span class="sig-name descname"><span class="pre">set_training_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/graph/op_utils.html#set_training_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.graph.set_training_mode" title="Link to this definition">¶</a></dt>
<dd><p>Set the training mode.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ldp</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ldp</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ldp.html">ldp package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ldp.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ldp.agent.html">ldp.agent package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.html">ldp.alg package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ldp.graph package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.llms.html">ldp.llms package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.data_structures">ldp.data_structures module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.main">ldp.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.shims">ldp.shims module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.utils">ldp.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ldp</a><ul>
  <li><a href="ldp.html">ldp package</a><ul>
      <li>Previous: <a href="ldp.alg.optimizer.html" title="previous chapter">ldp.alg.optimizer package</a></li>
      <li>Next: <a href="ldp.graph.modules.html" title="next chapter">ldp.graph.modules package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/ldp.graph.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>