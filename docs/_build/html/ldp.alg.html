<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>ldp.alg package &#8212; ldp  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ldp.alg.optimizer package" href="ldp.alg.optimizer.html" />
    <link rel="prev" title="ldp.agent package" href="ldp.agent.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ldp-alg-package">
<h1>ldp.alg package<a class="headerlink" href="#ldp-alg-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ldp.alg.optimizer.html">ldp.alg.optimizer package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#module-ldp.alg.optimizer.ape">ldp.alg.optimizer.ape module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt"><code class="docutils literal notranslate"><span class="pre">APEOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">APEOpt.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.from_agent"><code class="docutils literal notranslate"><span class="pre">APEOpt.from_agent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.good_examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.good_examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.good_reward_threshold"><code class="docutils literal notranslate"><span class="pre">APEOpt.good_reward_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.llm"><code class="docutils literal notranslate"><span class="pre">APEOpt.llm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.llm_call_op"><code class="docutils literal notranslate"><span class="pre">APEOpt.llm_call_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.max_examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.max_examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.model_config"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.model_post_init"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.prompt_op"><code class="docutils literal notranslate"><span class="pre">APEOpt.prompt_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.query_prompt"><code class="docutils literal notranslate"><span class="pre">APEOpt.query_prompt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.reward_discount"><code class="docutils literal notranslate"><span class="pre">APEOpt.reward_discount</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.score_fn"><code class="docutils literal notranslate"><span class="pre">APEOpt.score_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.steps"><code class="docutils literal notranslate"><span class="pre">APEOpt.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.system_prompt"><code class="docutils literal notranslate"><span class="pre">APEOpt.system_prompt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.trace"><code class="docutils literal notranslate"><span class="pre">APEOpt.trace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.update"><code class="docutils literal notranslate"><span class="pre">APEOpt.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEOpt.validate_score_fn"><code class="docutils literal notranslate"><span class="pre">APEOpt.validate_score_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEScoreFn"><code class="docutils literal notranslate"><span class="pre">APEScoreFn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEScoreFn.GRADIENT"><code class="docutils literal notranslate"><span class="pre">APEScoreFn.GRADIENT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.APEScoreFn.REWARD"><code class="docutils literal notranslate"><span class="pre">APEScoreFn.REWARD</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example"><code class="docutils literal notranslate"><span class="pre">Example</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.input"><code class="docutils literal notranslate"><span class="pre">Example.input</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">Example.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.model_config"><code class="docutils literal notranslate"><span class="pre">Example.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.model_fields"><code class="docutils literal notranslate"><span class="pre">Example.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.output"><code class="docutils literal notranslate"><span class="pre">Example.output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.Example.score"><code class="docutils literal notranslate"><span class="pre">Example.score</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.OutputPrompt"><code class="docutils literal notranslate"><span class="pre">OutputPrompt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.OutputPrompt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">OutputPrompt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.OutputPrompt.model_config"><code class="docutils literal notranslate"><span class="pre">OutputPrompt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.OutputPrompt.model_fields"><code class="docutils literal notranslate"><span class="pre">OutputPrompt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.OutputPrompt.prompt"><code class="docutils literal notranslate"><span class="pre">OutputPrompt.prompt</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ape.get_formatted_variables"><code class="docutils literal notranslate"><span class="pre">get_formatted_variables()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#module-ldp.alg.optimizer.memory">ldp.alg.optimizer.memory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryFactory"><code class="docutils literal notranslate"><span class="pre">MemoryFactory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt"><code class="docutils literal notranslate"><span class="pre">MemoryOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.default_memory_factory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.default_memory_factory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.example_buffer"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.example_buffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.from_agent"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.from_agent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.memory_factory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_factory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.memory_op"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.memory_template"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.model_config"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.output_op"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.output_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.reward_discount"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.reward_discount</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.steps"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.MemoryOpt.update"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.PositiveMemoryOpt"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.PositiveMemoryOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.PositiveMemoryOpt.model_config"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.memory.PositiveMemoryOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_fields</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#module-ldp.alg.optimizer.opt">ldp.alg.optimizer.opt module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.ChainedOptimizer"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.ChainedOptimizer.aggregate"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.ChainedOptimizer.update"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer"><code class="docutils literal notranslate"><span class="pre">Optimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer.aggregate"><code class="docutils literal notranslate"><span class="pre">Optimizer.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">Optimizer.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer.update"><code class="docutils literal notranslate"><span class="pre">Optimizer.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#module-ldp.alg.optimizer.replay_buffers">ldp.alg.optimizer.replay_buffers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.replay_buffers.CircularReplayBuffer"><code class="docutils literal notranslate"><span class="pre">CircularReplayBuffer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.replay_buffers.CircularReplayBuffer.batched_iter"><code class="docutils literal notranslate"><span class="pre">CircularReplayBuffer.batched_iter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.replay_buffers.CircularReplayBuffer.resize"><code class="docutils literal notranslate"><span class="pre">CircularReplayBuffer.resize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldp.alg.optimizer.html#module-ldp.alg.optimizer">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt"><code class="docutils literal notranslate"><span class="pre">APEOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">APEOpt.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.from_agent"><code class="docutils literal notranslate"><span class="pre">APEOpt.from_agent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.good_examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.good_examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.good_reward_threshold"><code class="docutils literal notranslate"><span class="pre">APEOpt.good_reward_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.llm"><code class="docutils literal notranslate"><span class="pre">APEOpt.llm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.llm_call_op"><code class="docutils literal notranslate"><span class="pre">APEOpt.llm_call_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.max_examples"><code class="docutils literal notranslate"><span class="pre">APEOpt.max_examples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.model_config"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.model_post_init"><code class="docutils literal notranslate"><span class="pre">APEOpt.model_post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.prompt_op"><code class="docutils literal notranslate"><span class="pre">APEOpt.prompt_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.query_prompt"><code class="docutils literal notranslate"><span class="pre">APEOpt.query_prompt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.reward_discount"><code class="docutils literal notranslate"><span class="pre">APEOpt.reward_discount</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.score_fn"><code class="docutils literal notranslate"><span class="pre">APEOpt.score_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.steps"><code class="docutils literal notranslate"><span class="pre">APEOpt.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.system_prompt"><code class="docutils literal notranslate"><span class="pre">APEOpt.system_prompt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.trace"><code class="docutils literal notranslate"><span class="pre">APEOpt.trace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.update"><code class="docutils literal notranslate"><span class="pre">APEOpt.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEOpt.validate_score_fn"><code class="docutils literal notranslate"><span class="pre">APEOpt.validate_score_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEScoreFn"><code class="docutils literal notranslate"><span class="pre">APEScoreFn</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEScoreFn.GRADIENT"><code class="docutils literal notranslate"><span class="pre">APEScoreFn.GRADIENT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.APEScoreFn.REWARD"><code class="docutils literal notranslate"><span class="pre">APEScoreFn.REWARD</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ChainedOptimizer"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ChainedOptimizer.aggregate"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.ChainedOptimizer.update"><code class="docutils literal notranslate"><span class="pre">ChainedOptimizer.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryFactory"><code class="docutils literal notranslate"><span class="pre">MemoryFactory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt"><code class="docutils literal notranslate"><span class="pre">MemoryOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.default_memory_factory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.default_memory_factory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.example_buffer"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.example_buffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.from_agent"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.from_agent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.memory_factory"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_factory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.memory_op"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.memory_template"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.memory_template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.model_config"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.output_op"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.output_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.reward_discount"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.reward_discount</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.steps"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.MemoryOpt.update"><code class="docutils literal notranslate"><span class="pre">MemoryOpt.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.Optimizer"><code class="docutils literal notranslate"><span class="pre">Optimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.Optimizer.aggregate"><code class="docutils literal notranslate"><span class="pre">Optimizer.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.Optimizer.aggregate_trajectory"><code class="docutils literal notranslate"><span class="pre">Optimizer.aggregate_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.Optimizer.update"><code class="docutils literal notranslate"><span class="pre">Optimizer.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig.model_fields"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig.optimizer_kwargs"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig.optimizer_kwargs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.OptimizerConfig.optimizer_type"><code class="docutils literal notranslate"><span class="pre">OptimizerConfig.optimizer_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.example_buffer"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.example_buffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.memory_factory"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.memory_factory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.memory_op"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.memory_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.memory_template"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.memory_template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.model_config"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.model_fields"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.output_op"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.output_op</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.reward_discount"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.reward_discount</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.PositiveMemoryOpt.steps"><code class="docutils literal notranslate"><span class="pre">PositiveMemoryOpt.steps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.default_optimizer_factory"><code class="docutils literal notranslate"><span class="pre">default_optimizer_factory()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ldp.alg.algorithms">
<span id="ldp-alg-algorithms-module"></span><h2>ldp.alg.algorithms module<a class="headerlink" href="#module-ldp.alg.algorithms" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ldp.alg.algorithms.to_network">
<span class="sig-prename descclassname"><span class="pre">ldp.alg.algorithms.</span></span><span class="sig-name descname"><span class="pre">to_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_label_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_label_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MultiDiGraph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MultiDiGraph</span></span></span><a class="reference internal" href="_modules/ldp/alg/algorithms.html#to_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.algorithms.to_network" title="Link to this definition">¶</a></dt>
<dd><p>Populate a NetworkX graph from the input op result’s computation graph.</p>
<p>How to export Graphviz .dot file: nx.drawing.nx_pydot.write_dot(G, “file.dot”)
How to render with Graphviz: nx.drawing.nx_pydot.to_pydot(G).write_png(“file.png”)
Online Graphviz renderer: <a class="reference external" href="https://dreampuf.github.io/GraphvizOnline/">https://dreampuf.github.io/GraphvizOnline/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op_result</strong> – Starting op result to recurse parent op calls and results.</p></li>
<li><p><strong>max_label_height</strong> – Optional max label height (lines).</p></li>
<li><p><strong>max_label_width</strong> – Optional max label width (chars).</p></li>
<li><p><strong>G</strong> – Optional graph to add nodes/edges to. Allows this to be a recursive function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Populated a NetworkX multi-edge directed graph.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ldp.alg.beam_search">
<span id="ldp-alg-beam-search-module"></span><h2>ldp.alg.beam_search module<a class="headerlink" href="#module-ldp.alg.beam_search" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.beam_search.Beam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.beam_search.</span></span><span class="sig-name descname"><span class="pre">Beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#Beam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.beam_search.Beam" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.beam_search.Beam.env">
<span class="sig-name descname"><span class="pre">env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Environment</span></em><a class="headerlink" href="#ldp.alg.beam_search.Beam.env" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.beam_search.Beam.traj">
<span class="sig-name descname"><span class="pre">traj</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a></em><a class="headerlink" href="#ldp.alg.beam_search.Beam.traj" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.beam_search.BeamSearchRollout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.beam_search.</span></span><span class="sig-name descname"><span class="pre">BeamSearchRollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples_per_beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TAgentState</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TAgentState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_actions_on_clone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#BeamSearchRollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.beam_search.BeamSearchRollout" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.beam_search.BeamSearchRollout.sample_trajectories">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Environment</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#BeamSearchRollout.sample_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.beam_search.BeamSearchRollout.sample_trajectories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.alg.callbacks">
<span id="ldp-alg-callbacks-module"></span><h2>ldp.alg.callbacks module<a class="headerlink" href="#module-ldp.alg.callbacks" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">Callback</span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for callbacks used by RolloutManager/Evaluator/OnlineTrainer.</p>
<p>Pseudocode to demonstrate how callback methods are invoked (marked as <a href="#id1"><span class="problematic" id="id2">*</span></a>):</p>
<dl>
<dt>RolloutManager.sample_trajectories():</dt><dd><p>env.reset()
callback.after_env_reset() *
agent.init_state()
callback.after_agent_init_state() *
while not done:</p>
<blockquote>
<div><p>callback.before_transition() *
agent.get_asv()
callback.after_agent_get_asv() *
env.step()
callback.after_env_step() *
callback.after_transition() *</p>
</div></blockquote>
</dd>
<dt>Evaluator.evaluate / OnlineTrainer._eval_loop():</dt><dd><p>callback.before_eval_loop() *
for batch in eval_dataset:</p>
<blockquote>
<div><p>rollout_manager.sample_trajectories()
callback.after_eval_step() *</p>
</div></blockquote>
<p>callback.after_eval_loop() *</p>
</dd>
<dt>OfflineTrainer / OnlineTrainer.train():</dt><dd><dl>
<dt>for batch in train_dataset:</dt><dd><p>rollout_manager.sample_trajectories() # if online
optimizer.aggregate()
if updating_optimizer:</p>
<blockquote>
<div><p>optimizer.update()
callback.after_update() *</p>
</div></blockquote>
<p>callback.after_train_step() *</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_agent_get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_agent_get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_agent_get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.get_asv().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_agent_init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_agent_init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_agent_init_state" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.init_state().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_env_reset">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_env_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_env_reset" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.reset().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_env_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_env_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.step().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.html#ldp.data_structures.Transition" title="ldp.data_structures.Transition"><span class="pre">Transition</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after each transition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.after_update">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.after_update" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each optimizer.update() call.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.before_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.before_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.before_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer before the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.Callback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.Callback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ClearContextCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">ClearContextCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.ClearContextCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ClearContextCallback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.ClearContextCallback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ClearContextCallback.after_update">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.ClearContextCallback.after_update" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each optimizer.update() call.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ComputeTrajectoryMetricsMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">ComputeTrajectoryMetricsMixin</span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ComputeTrajectoryMetricsMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.ComputeTrajectoryMetricsMixin" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mixin for TaskDataset classes to enable them to compute metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ComputeTrajectoryMetricsMixin.compute_trajectory_metrics">
<span class="sig-name descname"><span class="pre">compute_trajectory_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ComputeTrajectoryMetricsMixin.compute_trajectory_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.ComputeTrajectoryMetricsMixin.compute_trajectory_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.callbacks.ComputeTrajectoryMetricsMixin.tools_to_track">
<span class="sig-name descname"><span class="pre">tools_to_track</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.callbacks.ComputeTrajectoryMetricsMixin.tools_to_track" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.LoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">LoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.LoggingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.MeanMetricsCallback" title="ldp.alg.callbacks.MeanMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanMetricsCallback</span></code></a></p>
<p>Custom callback for logging filtered metrics (e.g., pass rates) to the console.</p>
<p>This callback extends the <cite>MeanMetricsCallback</cite> and allows logging of user-specified metrics
after each training step and after the evaluation loop. It calculates the specified metrics
(e.g., pass rates) from the trajectories and logs the results.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.LoggingCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.LoggingCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Log metrics and pass rate after the evaluation loop.</p>
<p>This method is called after the evaluation loop finishes, calculating and logging
the evaluation metrics and pass rate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.LoggingCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.LoggingCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Log metrics and pass rate after each training step.</p>
<p>This method is called after every training step, calculating and logging
the training metrics and pass rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> – A sequence of trajectories from the training step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.MeanMetricsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">MeanMetricsCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.MeanMetricsCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.TrajectoryMetricsCallback" title="ldp.alg.callbacks.TrajectoryMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryMetricsCallback</span></code></a></p>
<p>Take a mean of all metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.MeanMetricsCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.MeanMetricsCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.MeanMetricsCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.MeanMetricsCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.alg.callbacks.MeanMetricsCallback.eval_means">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_means</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.alg.callbacks.MeanMetricsCallback.eval_means" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.alg.callbacks.MeanMetricsCallback.train_means">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_means</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.alg.callbacks.MeanMetricsCallback.train_means" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.RolloutDebugDumpCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">RolloutDebugDumpCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.RolloutDebugDumpCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Dump JSONL files for each agent and environment step to a directory.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.RolloutDebugDumpCallback.after_agent_get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.after_agent_get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.RolloutDebugDumpCallback.after_agent_get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.get_asv().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.RolloutDebugDumpCallback.after_env_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.after_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.RolloutDebugDumpCallback.after_env_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.step().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.RolloutDebugDumpCallback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.RolloutDebugDumpCallback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TerminalPrintingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">TerminalPrintingCallback</span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TerminalPrintingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TerminalPrintingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Callback that prints action, observation, and timing information to the terminal.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TerminalPrintingCallback.after_agent_get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TerminalPrintingCallback.after_agent_get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TerminalPrintingCallback.after_agent_get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.get_asv().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TerminalPrintingCallback.after_env_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TerminalPrintingCallback.after_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TerminalPrintingCallback.after_env_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.step().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TerminalPrintingCallback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TerminalPrintingCallback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TerminalPrintingCallback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Start the timer before each transition.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryFileCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">TrajectoryFileCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryFileCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Callback that writes trajectories to a file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryFileCallback.after_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.html#ldp.data_structures.Transition" title="ldp.data_structures.Transition"><span class="pre">Transition</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.after_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryFileCallback.after_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after each transition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryFileCallback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryFileCallback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryFileCallback.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryFileCallback.cleanup" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryMetricsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">TrajectoryMetricsCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_tool_usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryMetricsCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Compute metrics that are defined by task datasets.</p>
<p>NOTE: evaluation portion’s after_eval_step/loop() is not concurrency safe because
trajectories should be stored in the order of after_eval_step() calls.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryMetricsCallback.after_env_reset">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_env_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryMetricsCallback.after_env_reset" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.reset().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryMetricsCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryMetricsCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryMetricsCallback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryMetricsCallback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.TrajectoryMetricsCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.TrajectoryMetricsCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.callbacks.WandBLoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.callbacks.</span></span><span class="sig-name descname"><span class="pre">WandBLoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.WandBLoggingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.TrajectoryMetricsCallback" title="ldp.alg.callbacks.TrajectoryMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryMetricsCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.WandBLoggingCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.WandBLoggingCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.callbacks.WandBLoggingCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.callbacks.WandBLoggingCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ldp.alg.datasets">
<span id="ldp-alg-datasets-module"></span><h2>ldp.alg.datasets module<a class="headerlink" href="#module-ldp.alg.datasets" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.datasets.DummyTaskDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.datasets.</span></span><span class="sig-name descname"><span class="pre">DummyTaskDataset</span></span><a class="reference internal" href="_modules/ldp/alg/datasets.html#DummyTaskDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.datasets.DummyTaskDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyTaskDataset</span></code>, <a class="reference internal" href="#ldp.alg.callbacks.ComputeTrajectoryMetricsMixin" title="ldp.alg.callbacks.ComputeTrajectoryMetricsMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComputeTrajectoryMetricsMixin</span></code></a></p>
</dd></dl>

</section>
<section id="module-ldp.alg.rollout">
<span id="ldp-alg-rollout-module"></span><h2>ldp.alg.rollout module<a class="headerlink" href="#module-ldp.alg.rollout" title="Link to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="ldp.alg.rollout.AgentError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.rollout.</span></span><span class="sig-name descname"><span class="pre">AgentError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Exception</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/rollout.html#AgentError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.AgentError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.rollout.CaughtError" title="ldp.alg.rollout.CaughtError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CaughtError</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.rollout.AgentError.exc_type">
<span class="sig-name descname"><span class="pre">exc_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'agent'</span></em><a class="headerlink" href="#ldp.alg.rollout.AgentError.exc_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ldp.alg.rollout.CaughtError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.rollout.</span></span><span class="sig-name descname"><span class="pre">CaughtError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Exception</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/rollout.html#CaughtError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.CaughtError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for reraised exceptions when catching is enabled.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.rollout.CaughtError.exc_type">
<span class="sig-name descname"><span class="pre">exc_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'undefined'</span></em><a class="headerlink" href="#ldp.alg.rollout.CaughtError.exc_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ldp.alg.rollout.EnvError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.rollout.</span></span><span class="sig-name descname"><span class="pre">EnvError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Exception</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/rollout.html#EnvError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.EnvError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.rollout.CaughtError" title="ldp.alg.rollout.CaughtError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CaughtError</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.rollout.EnvError.exc_type">
<span class="sig-name descname"><span class="pre">exc_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'env'</span></em><a class="headerlink" href="#ldp.alg.rollout.EnvError.exc_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.rollout.RolloutManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.rollout.</span></span><span class="sig-name descname"><span class="pre">RolloutManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concurrency_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/rollout.html#RolloutManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.RolloutManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.rollout.RolloutManager.sample_trajectories">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/rollout.html#RolloutManager.sample_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.RolloutManager.sample_trajectories" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Environment</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.alg.rollout.reraise_exc_as">
<span class="sig-prename descclassname"><span class="pre">ldp.alg.rollout.</span></span><span class="sig-name descname"><span class="pre">reraise_exc_as</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reraise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.rollout.CaughtError" title="ldp.alg.rollout.CaughtError"><span class="pre">CaughtError</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/rollout.html#reraise_exc_as"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.rollout.reraise_exc_as" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ldp.alg.runners">
<span id="ldp-alg-runners-module"></span><h2>ldp.alg.runners module<a class="headerlink" href="#module-ldp.alg.runners" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.Evaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.EvaluatorConfig" title="ldp.alg.runners.EvaluatorConfig"><span class="pre">EvaluatorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#Evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.Evaluator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.Evaluator.evaluate">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ldp.alg.runners.Evaluator.evaluate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.Evaluator.run">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#Evaluator.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.Evaluator.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the agent over the provided dataset.</p>
<p>This method does not set training mode, so it can be used to collect
trajectories for offline training.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">EvaluatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rollout_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#EvaluatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.catch_agent_failures">
<span class="sig-name descname"><span class="pre">catch_agent_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.catch_agent_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.catch_env_failures">
<span class="sig-name descname"><span class="pre">catch_env_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.catch_env_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.make_rollout_manager">
<span class="sig-name descname"><span class="pre">make_rollout_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.alg.rollout.RolloutManager" title="ldp.alg.rollout.RolloutManager"><span class="pre">RolloutManager</span></a></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#EvaluatorConfig.make_rollout_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.make_rollout_manager" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.max_rollout_steps">
<span class="sig-name descname"><span class="pre">max_rollout_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.max_rollout_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1),</span> <span class="pre">'catch_agent_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'catch_env_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'max_rollout_steps':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None),</span> <span class="pre">'num_eval_iterations':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">eval</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">will</span> <span class="pre">exhaust</span> <span class="pre">the</span> <span class="pre">dataset.</span> <span class="pre">If</span> <span class="pre">0,</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">eval</span> <span class="pre">loop.</span> <span class="pre">')}</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.EvaluatorConfig.num_eval_iterations">
<span class="sig-name descname"><span class="pre">num_eval_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.runners.EvaluatorConfig.num_eval_iterations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">OfflineTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.OfflineTrainerConfig" title="ldp.alg.runners.OfflineTrainerConfig"><span class="pre">OfflineTrainerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer" title="ldp.alg.optimizer.opt.Optimizer"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OfflineTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainer.train">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OfflineTrainer.train" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">OfflineTrainerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'update_every':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">training</span> <span class="pre">iterations</span> <span class="pre">to</span> <span class="pre">run</span> <span class="pre">before</span> <span class="pre">updating</span> <span class="pre">the</span> <span class="pre">model.',</span> <span class="pre">metadata=[Ge(ge=1)])}</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OfflineTrainerConfig.update_every">
<span class="sig-name descname"><span class="pre">update_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OfflineTrainerConfig.update_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">OnlineTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.OnlineTrainerConfig" title="ldp.alg.runners.OnlineTrainerConfig"><span class="pre">OnlineTrainerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer" title="ldp.alg.optimizer.opt.Optimizer"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OnlineTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainer.evaluate">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ldp.alg.runners.OnlineTrainer.evaluate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainer.train">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OnlineTrainer.train" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.runners.</span></span><span class="sig-name descname"><span class="pre">OnlineTrainerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rollout_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_train_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts_per_env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.runners.EvaluatorConfig" title="ldp.alg.runners.EvaluatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluatorConfig</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.eval_before">
<span class="sig-name descname"><span class="pre">eval_before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.eval_before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.eval_every">
<span class="sig-name descname"><span class="pre">eval_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.eval_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True),</span> <span class="pre">'catch_agent_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'catch_env_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'eval_before':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True,</span> <span class="pre">description='If</span> <span class="pre">True</span> <span class="pre">(default),</span> <span class="pre">evaluate</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">validation</span> <span class="pre">set</span> <span class="pre">before</span> <span class="pre">kicking</span> <span class="pre">off</span> <span class="pre">training.'),</span> <span class="pre">'eval_every':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='If</span> <span class="pre">set,</span> <span class="pre">will</span> <span class="pre">repeatedly</span> <span class="pre">evaluate</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">validation</span> <span class="pre">set</span> <span class="pre">after</span> <span class="pre">this</span> <span class="pre">many</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">unset</span> <span class="pre">(default),</span> <span class="pre">no</span> <span class="pre">evaluation</span> <span class="pre">is</span> <span class="pre">performed.'),</span> <span class="pre">'max_rollout_steps':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None),</span> <span class="pre">'num_eval_iterations':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">eval</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">will</span> <span class="pre">exhaust</span> <span class="pre">the</span> <span class="pre">dataset.</span> <span class="pre">If</span> <span class="pre">0,</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">eval</span> <span class="pre">loop.</span> <span class="pre">'),</span> <span class="pre">'num_rollouts_per_env':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">rollouts</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">environment</span> <span class="pre">per</span> <span class="pre">training</span> <span class="pre">iteration.'),</span> <span class="pre">'num_train_iterations':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">iterations</span> <span class="pre">(at</span> <span class="pre">one</span> <span class="pre">batch</span> <span class="pre">per</span> <span class="pre">iteration)</span> <span class="pre">to</span> <span class="pre">process</span> <span class="pre">during</span> <span class="pre">training,</span> <span class="pre">and</span> <span class="pre">setting</span> <span class="pre">to</span> <span class="pre">0</span> <span class="pre">skips</span> <span class="pre">training.',</span> <span class="pre">metadata=[Ge(ge=0)]),</span> <span class="pre">'update_every':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">training</span> <span class="pre">iterations</span> <span class="pre">between</span> <span class="pre">optimizer</span> <span class="pre">update</span> <span class="pre">calls.',</span> <span class="pre">metadata=[Ge(ge=1)])}</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.num_rollouts_per_env">
<span class="sig-name descname"><span class="pre">num_rollouts_per_env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.num_rollouts_per_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.num_train_iterations">
<span class="sig-name descname"><span class="pre">num_train_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.num_train_iterations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.runners.OnlineTrainerConfig.update_every">
<span class="sig-name descname"><span class="pre">update_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.runners.OnlineTrainerConfig.update_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.alg.tree_search">
<span id="ldp-alg-tree-search-module"></span><h2>ldp.alg.tree_search module<a class="headerlink" href="#module-ldp.alg.tree_search" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.tree_search.TreeSearchRollout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.tree_search.</span></span><span class="sig-name descname"><span class="pre">TreeSearchRollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">branching_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concurrency_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.tree_search.TreeSearchRollout" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.rollout.RolloutManager" title="ldp.alg.rollout.RolloutManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">RolloutManager</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.tree_search.TreeSearchRollout.sample_tree">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TEnv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="ldp.html#ldp.data_structures.TransitionTree" title="ldp.data_structures.TransitionTree"><span class="pre">TransitionTree</span></a></span></span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout.sample_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.tree_search.TreeSearchRollout.sample_tree" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.tree_search.TreeSearchRollout.sample_trees">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.TransitionTree" title="ldp.data_structures.TransitionTree"><span class="pre">TransitionTree</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout.sample_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.tree_search.TreeSearchRollout.sample_trees" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ldp.alg">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ldp.alg" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.Beam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">Beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#Beam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Beam" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.Beam.env">
<span class="sig-name descname"><span class="pre">env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Environment</span></em><a class="headerlink" href="#ldp.alg.Beam.env" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.Beam.traj">
<span class="sig-name descname"><span class="pre">traj</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a></em><a class="headerlink" href="#ldp.alg.Beam.traj" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.BeamSearchRollout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">BeamSearchRollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples_per_beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TAgentState</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TAgentState</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_actions_on_clone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#BeamSearchRollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.BeamSearchRollout" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.BeamSearchRollout.sample_trajectories">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Environment</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/beam_search.html#BeamSearchRollout.sample_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.BeamSearchRollout.sample_trajectories" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.Callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">Callback</span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for callbacks used by RolloutManager/Evaluator/OnlineTrainer.</p>
<p>Pseudocode to demonstrate how callback methods are invoked (marked as <a href="#id3"><span class="problematic" id="id4">*</span></a>):</p>
<dl>
<dt>RolloutManager.sample_trajectories():</dt><dd><p>env.reset()
callback.after_env_reset() *
agent.init_state()
callback.after_agent_init_state() *
while not done:</p>
<blockquote>
<div><p>callback.before_transition() *
agent.get_asv()
callback.after_agent_get_asv() *
env.step()
callback.after_env_step() *
callback.after_transition() *</p>
</div></blockquote>
</dd>
<dt>Evaluator.evaluate / OnlineTrainer._eval_loop():</dt><dd><p>callback.before_eval_loop() *
for batch in eval_dataset:</p>
<blockquote>
<div><p>rollout_manager.sample_trajectories()
callback.after_eval_step() *</p>
</div></blockquote>
<p>callback.after_eval_loop() *</p>
</dd>
<dt>OfflineTrainer / OnlineTrainer.train():</dt><dd><dl>
<dt>for batch in train_dataset:</dt><dd><p>rollout_manager.sample_trajectories() # if online
optimizer.aggregate()
if updating_optimizer:</p>
<blockquote>
<div><p>optimizer.update()
callback.after_update() *</p>
</div></blockquote>
<p>callback.after_train_step() *</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_agent_get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_agent_get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_agent_get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.get_asv().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_agent_init_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_agent_init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_agent_init_state" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.init_state().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_env_reset">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_env_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_env_reset" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.reset().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_env_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_env_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.step().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.html#ldp.data_structures.Transition" title="ldp.data_structures.Transition"><span class="pre">Transition</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after each transition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.after_update">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.after_update" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each optimizer.update() call.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.before_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.before_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.before_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer before the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Callback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#Callback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Callback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.ClearContextCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">ClearContextCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.ClearContextCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.ClearContextCallback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.ClearContextCallback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.ClearContextCallback.after_update">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ClearContextCallback.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.ClearContextCallback.after_update" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each optimizer.update() call.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.ComputeTrajectoryMetricsMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">ComputeTrajectoryMetricsMixin</span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ComputeTrajectoryMetricsMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.ComputeTrajectoryMetricsMixin" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mixin for TaskDataset classes to enable them to compute metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.ComputeTrajectoryMetricsMixin.compute_trajectory_metrics">
<span class="sig-name descname"><span class="pre">compute_trajectory_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#ComputeTrajectoryMetricsMixin.compute_trajectory_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.ComputeTrajectoryMetricsMixin.compute_trajectory_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.ComputeTrajectoryMetricsMixin.tools_to_track">
<span class="sig-name descname"><span class="pre">tools_to_track</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.ComputeTrajectoryMetricsMixin.tools_to_track" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.Evaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.EvaluatorConfig" title="ldp.alg.runners.EvaluatorConfig"><span class="pre">EvaluatorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#Evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Evaluator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Evaluator.evaluate">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ldp.alg.Evaluator.evaluate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.Evaluator.run">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#Evaluator.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.Evaluator.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the agent over the provided dataset.</p>
<p>This method does not set training mode, so it can be used to collect
trajectories for offline training.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">EvaluatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rollout_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#EvaluatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.EvaluatorConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.catch_agent_failures">
<span class="sig-name descname"><span class="pre">catch_agent_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.catch_agent_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.catch_env_failures">
<span class="sig-name descname"><span class="pre">catch_env_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.catch_env_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.make_rollout_manager">
<span class="sig-name descname"><span class="pre">make_rollout_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ldp.alg.rollout.RolloutManager" title="ldp.alg.rollout.RolloutManager"><span class="pre">RolloutManager</span></a></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#EvaluatorConfig.make_rollout_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.EvaluatorConfig.make_rollout_manager" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.max_rollout_steps">
<span class="sig-name descname"><span class="pre">max_rollout_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.max_rollout_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1),</span> <span class="pre">'catch_agent_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'catch_env_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'max_rollout_steps':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None),</span> <span class="pre">'num_eval_iterations':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">eval</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">will</span> <span class="pre">exhaust</span> <span class="pre">the</span> <span class="pre">dataset.</span> <span class="pre">If</span> <span class="pre">0,</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">eval</span> <span class="pre">loop.</span> <span class="pre">')}</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.EvaluatorConfig.num_eval_iterations">
<span class="sig-name descname"><span class="pre">num_eval_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.EvaluatorConfig.num_eval_iterations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.LoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">LoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.LoggingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.MeanMetricsCallback" title="ldp.alg.callbacks.MeanMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanMetricsCallback</span></code></a></p>
<p>Custom callback for logging filtered metrics (e.g., pass rates) to the console.</p>
<p>This callback extends the <cite>MeanMetricsCallback</cite> and allows logging of user-specified metrics
after each training step and after the evaluation loop. It calculates the specified metrics
(e.g., pass rates) from the trajectories and logs the results.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.LoggingCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.LoggingCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Log metrics and pass rate after the evaluation loop.</p>
<p>This method is called after the evaluation loop finishes, calculating and logging
the evaluation metrics and pass rate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.LoggingCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#LoggingCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.LoggingCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Log metrics and pass rate after each training step.</p>
<p>This method is called after every training step, calculating and logging
the training metrics and pass rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trajectories</strong> – A sequence of trajectories from the training step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.MeanMetricsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">MeanMetricsCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.MeanMetricsCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.TrajectoryMetricsCallback" title="ldp.alg.callbacks.TrajectoryMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryMetricsCallback</span></code></a></p>
<p>Take a mean of all metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.MeanMetricsCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.MeanMetricsCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.MeanMetricsCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#MeanMetricsCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.MeanMetricsCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.alg.MeanMetricsCallback.eval_means">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_means</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.alg.MeanMetricsCallback.eval_means" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ldp.alg.MeanMetricsCallback.train_means">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_means</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ldp.alg.MeanMetricsCallback.train_means" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">OfflineTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.OfflineTrainerConfig" title="ldp.alg.runners.OfflineTrainerConfig"><span class="pre">OfflineTrainerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer" title="ldp.alg.optimizer.opt.Optimizer"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OfflineTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainer.train">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OfflineTrainer.train" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">OfflineTrainerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OfflineTrainerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'update_every':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">training</span> <span class="pre">iterations</span> <span class="pre">to</span> <span class="pre">run</span> <span class="pre">before</span> <span class="pre">updating</span> <span class="pre">the</span> <span class="pre">model.',</span> <span class="pre">metadata=[Ge(ge=1)])}</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OfflineTrainerConfig.update_every">
<span class="sig-name descname"><span class="pre">update_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OfflineTrainerConfig.update_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">OnlineTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ldp.alg.runners.OnlineTrainerConfig" title="ldp.alg.runners.OnlineTrainerConfig"><span class="pre">OnlineTrainerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.alg.optimizer.html#ldp.alg.optimizer.opt.Optimizer" title="ldp.alg.optimizer.opt.Optimizer"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OnlineTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainer.evaluate">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ldp.alg.OnlineTrainer.evaluate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainer.train">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OnlineTrainer.train" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">OnlineTrainerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rollout_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_ctx_at_each_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_train_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts_per_env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/runners.html#OnlineTrainerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.runners.EvaluatorConfig" title="ldp.alg.runners.EvaluatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluatorConfig</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.catch_agent_failures">
<span class="sig-name descname"><span class="pre">catch_agent_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.catch_agent_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.catch_env_failures">
<span class="sig-name descname"><span class="pre">catch_env_failures</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.catch_env_failures" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.clear_ctx_at_each_iter">
<span class="sig-name descname"><span class="pre">clear_ctx_at_each_iter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.clear_ctx_at_each_iter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.eval_before">
<span class="sig-name descname"><span class="pre">eval_before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.eval_before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.eval_every">
<span class="sig-name descname"><span class="pre">eval_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.eval_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.max_rollout_steps">
<span class="sig-name descname"><span class="pre">max_rollout_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.max_rollout_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'forbid'}</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True),</span> <span class="pre">'catch_agent_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'catch_env_failures':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True),</span> <span class="pre">'clear_ctx_at_each_iter':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=False),</span> <span class="pre">'eval_before':</span> <span class="pre">FieldInfo(annotation=bool,</span> <span class="pre">required=False,</span> <span class="pre">default=True,</span> <span class="pre">description='If</span> <span class="pre">True</span> <span class="pre">(default),</span> <span class="pre">evaluate</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">validation</span> <span class="pre">set</span> <span class="pre">before</span> <span class="pre">kicking</span> <span class="pre">off</span> <span class="pre">training.'),</span> <span class="pre">'eval_every':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='If</span> <span class="pre">set,</span> <span class="pre">will</span> <span class="pre">repeatedly</span> <span class="pre">evaluate</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">validation</span> <span class="pre">set</span> <span class="pre">after</span> <span class="pre">this</span> <span class="pre">many</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">unset</span> <span class="pre">(default),</span> <span class="pre">no</span> <span class="pre">evaluation</span> <span class="pre">is</span> <span class="pre">performed.'),</span> <span class="pre">'max_rollout_steps':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None),</span> <span class="pre">'num_eval_iterations':</span> <span class="pre">FieldInfo(annotation=Union[int,</span> <span class="pre">NoneType],</span> <span class="pre">required=False,</span> <span class="pre">default=None,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">eval</span> <span class="pre">iterations.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">will</span> <span class="pre">exhaust</span> <span class="pre">the</span> <span class="pre">dataset.</span> <span class="pre">If</span> <span class="pre">0,</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">eval</span> <span class="pre">loop.</span> <span class="pre">'),</span> <span class="pre">'num_rollouts_per_env':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">rollouts</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">environment</span> <span class="pre">per</span> <span class="pre">training</span> <span class="pre">iteration.'),</span> <span class="pre">'num_train_iterations':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=True,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">iterations</span> <span class="pre">(at</span> <span class="pre">one</span> <span class="pre">batch</span> <span class="pre">per</span> <span class="pre">iteration)</span> <span class="pre">to</span> <span class="pre">process</span> <span class="pre">during</span> <span class="pre">training,</span> <span class="pre">and</span> <span class="pre">setting</span> <span class="pre">to</span> <span class="pre">0</span> <span class="pre">skips</span> <span class="pre">training.',</span> <span class="pre">metadata=[Ge(ge=0)]),</span> <span class="pre">'update_every':</span> <span class="pre">FieldInfo(annotation=int,</span> <span class="pre">required=False,</span> <span class="pre">default=1,</span> <span class="pre">description='Number</span> <span class="pre">of</span> <span class="pre">training</span> <span class="pre">iterations</span> <span class="pre">between</span> <span class="pre">optimizer</span> <span class="pre">update</span> <span class="pre">calls.',</span> <span class="pre">metadata=[Ge(ge=1)])}</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo].</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.num_eval_iterations">
<span class="sig-name descname"><span class="pre">num_eval_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.num_eval_iterations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.num_rollouts_per_env">
<span class="sig-name descname"><span class="pre">num_rollouts_per_env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.num_rollouts_per_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.num_train_iterations">
<span class="sig-name descname"><span class="pre">num_train_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.num_train_iterations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ldp.alg.OnlineTrainerConfig.update_every">
<span class="sig-name descname"><span class="pre">update_every</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ldp.alg.OnlineTrainerConfig.update_every" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.RolloutDebugDumpCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">RolloutDebugDumpCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutDebugDumpCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Dump JSONL files for each agent and environment step to a directory.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.RolloutDebugDumpCallback.after_agent_get_asv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_agent_get_asv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolRequestMessage</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.after_agent_get_asv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutDebugDumpCallback.after_agent_get_asv" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after agent.get_asv().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.RolloutDebugDumpCallback.after_env_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.after_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutDebugDumpCallback.after_env_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.step().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.RolloutDebugDumpCallback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#RolloutDebugDumpCallback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutDebugDumpCallback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.RolloutManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">RolloutManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concurrency_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/rollout.html#RolloutManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.RolloutManager.sample_trajectories">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/rollout.html#RolloutManager.sample_trajectories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.RolloutManager.sample_trajectories" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Environment</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryFileCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">TrajectoryFileCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryFileCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Callback that writes trajectories to a file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryFileCallback.after_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.html#ldp.data_structures.Transition" title="ldp.data_structures.Transition"><span class="pre">Transition</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.after_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryFileCallback.after_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after each transition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryFileCallback.before_transition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">before_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.before_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryFileCallback.before_transition" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners before each transition and after agent and env reset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryFileCallback.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryFileCallback.cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryFileCallback.cleanup" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryMetricsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">TrajectoryMetricsCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TaskDataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_tool_usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryMetricsCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></a></p>
<p>Compute metrics that are defined by task datasets.</p>
<p>NOTE: evaluation portion’s after_eval_step/loop() is not concurrency safe because
trajectories should be stored in the order of after_eval_step() calls.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryMetricsCallback.after_env_reset">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_env_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Message</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_env_reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryMetricsCallback.after_env_reset" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by runners after env.reset().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryMetricsCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryMetricsCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryMetricsCallback.after_eval_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_eval_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryMetricsCallback.after_eval_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after each evaluation step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TrajectoryMetricsCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#TrajectoryMetricsCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TrajectoryMetricsCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.TreeSearchRollout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">TreeSearchRollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.agent.html#ldp.agent.agent.Agent" title="ldp.agent.agent.Agent"><span class="pre">Agent</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">branching_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_clone_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_agent_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_env_failures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ldp.alg.callbacks.Callback" title="ldp.alg.callbacks.Callback"><span class="pre">Callback</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concurrency_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TreeSearchRollout" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.rollout.RolloutManager" title="ldp.alg.rollout.RolloutManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">RolloutManager</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TreeSearchRollout.sample_tree">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TEnv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="ldp.html#ldp.data_structures.TransitionTree" title="ldp.data_structures.TransitionTree"><span class="pre">TransitionTree</span></a></span></span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout.sample_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TreeSearchRollout.sample_tree" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.TreeSearchRollout.sample_trees">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">TEnv</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.TransitionTree" title="ldp.data_structures.TransitionTree"><span class="pre">TransitionTree</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/ldp/alg/tree_search.html#TreeSearchRollout.sample_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.TreeSearchRollout.sample_trees" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ldp.alg.WandBLoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">WandBLoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.WandBLoggingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ldp.alg.callbacks.TrajectoryMetricsCallback" title="ldp.alg.callbacks.TrajectoryMetricsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryMetricsCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.WandBLoggingCallback.after_eval_loop">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_eval_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback.after_eval_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.WandBLoggingCallback.after_eval_loop" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by Evaluator and OnlineTrainer after the evaluation loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ldp.alg.WandBLoggingCallback.after_train_step">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">after_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ldp.html#ldp.data_structures.Trajectory" title="ldp.data_structures.Trajectory"><span class="pre">Trajectory</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/ldp/alg/callbacks.html#WandBLoggingCallback.after_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.WandBLoggingCallback.after_train_step" title="Link to this definition">¶</a></dt>
<dd><p>Invoked by OnlineTrainer after each training step.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ldp.alg.to_network">
<span class="sig-prename descclassname"><span class="pre">ldp.alg.</span></span><span class="sig-name descname"><span class="pre">to_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ldp.graph.html#ldp.graph.ops.OpResult" title="ldp.graph.ops.OpResult"><span class="pre">OpResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_label_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_label_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MultiDiGraph</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MultiDiGraph</span></span></span><a class="reference internal" href="_modules/ldp/alg/algorithms.html#to_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ldp.alg.to_network" title="Link to this definition">¶</a></dt>
<dd><p>Populate a NetworkX graph from the input op result’s computation graph.</p>
<p>How to export Graphviz .dot file: nx.drawing.nx_pydot.write_dot(G, “file.dot”)
How to render with Graphviz: nx.drawing.nx_pydot.to_pydot(G).write_png(“file.png”)
Online Graphviz renderer: <a class="reference external" href="https://dreampuf.github.io/GraphvizOnline/">https://dreampuf.github.io/GraphvizOnline/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op_result</strong> – Starting op result to recurse parent op calls and results.</p></li>
<li><p><strong>max_label_height</strong> – Optional max label height (lines).</p></li>
<li><p><strong>max_label_width</strong> – Optional max label width (chars).</p></li>
<li><p><strong>G</strong> – Optional graph to add nodes/edges to. Allows this to be a recursive function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Populated a NetworkX multi-edge directed graph.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ldp</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ldp</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ldp.html">ldp package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ldp.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ldp.agent.html">ldp.agent package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ldp.alg package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.graph.html">ldp.graph package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ldp.llms.html">ldp.llms package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.data_structures">ldp.data_structures module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.main">ldp.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.shims">ldp.shims module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp.utils">ldp.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldp.html#module-ldp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ldp</a><ul>
  <li><a href="ldp.html">ldp package</a><ul>
      <li>Previous: <a href="ldp.agent.html" title="previous chapter">ldp.agent package</a></li>
      <li>Next: <a href="ldp.alg.optimizer.html" title="next chapter">ldp.alg.optimizer package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/ldp.alg.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>